{
  "updatedAt": "2026-01-23T18:41:25.061Z",
  "createdAt": "2026-01-23T18:38:21.921Z",
  "id": "ezzdhUM8oSPHv1c6FLrie",
  "name": "Slack AI Translation Bot",
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "slack-translate",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "b9e21341-5079-4b03-b0a7-71d828f20b49",
      "name": "Slack Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1008,
        16
      ],
      "webhookId": "slack-translate-webhook"
    },
    {
      "parameters": {
        "jsCode": "// Parse Slack event\nconst body = $json.body || $json;\n\nconsole.log('Received Slack event:', JSON.stringify(body, null, 2));\n\n// Handle Slack URL verification challenge\nif (body.type === 'url_verification') {\n  console.log('URL verification challenge');\n  return [{\n    json: { \n      challenge: body.challenge,\n      isChallenge: true \n    }\n  }];\n}\n\n// Handle slash command\nif (body.command) {\n  console.log('Slash command received:', body.command);\n  \n  const text = body.text || '';\n  const parts = text.trim().split(/\\s+/, 2);\n  const targetLang = parts[0] || 'en';\n  const textToTranslate = parts.slice(1).join(' ') || text;\n  \n  return [{\n    json: {\n      type: 'slash_command',\n      text: textToTranslate,\n      targetLanguage: targetLang,\n      channel: body.channel_id,\n      user: body.user_id,\n      responseUrl: body.response_url\n    }\n  }];\n}\n\n// Handle message event (bot mention)\nconst event = body.event || {};\n\n// Skip retries\nif ($json.headers?.['x-slack-retry-num']) {\n  console.log('Skipping Slack retry');\n  return [];\n}\n\n// Skip bot messages\nif (event.bot_id || event.subtype === 'bot_message') {\n  console.log('Skipping bot message');\n  return [];\n}\n\n// Check if message mentions the bot or has translation keywords\nconst messageText = event.text || '';\nconst lowerText = messageText.toLowerCase();\n\n// Translation keywords\nconst translationTriggers = [\n  'translate',\n  '×ª×¨×’×',\n  '×ª×¨×’×•×',\n  'Ğ¿ĞµÑ€ĞµĞ²ĞµĞ´Ğ¸',\n  'Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´'\n];\n\nconst hasTranslationTrigger = translationTriggers.some(trigger => \n  lowerText.includes(trigger)\n);\n\nif (!hasTranslationTrigger) {\n  console.log('Not a translation request');\n  return [];\n}\n\n// Parse translation request\n// Formats: \"translate to hebrew: text\" or \"translate he text\" or \"×ª×¨×’× ×œ×× ×’×œ×™×ª: ×˜×§×¡×˜\"\nlet targetLang = 'en';\nlet textToTranslate = messageText;\n\n// Try to extract target language and text\nconst patterns = [\n  /translate\\s+(?:to\\s+)?(\\w+)[:\\s]+(.+)/i,\n  /×ª×¨×’×\\s+(?:×œ)?(\\w+)[:\\s]+(.+)/i,\n  /Ğ¿ĞµÑ€ĞµĞ²ĞµĞ´Ğ¸\\s+(?:Ğ½Ğ°\\s+)?(\\w+)[:\\s]+(.+)/i\n];\n\nfor (const pattern of patterns) {\n  const match = messageText.match(pattern);\n  if (match) {\n    targetLang = match[1];\n    textToTranslate = match[2];\n    break;\n  }\n}\n\nconsole.log(`Translation request: ${textToTranslate.substring(0, 50)} -> ${targetLang}`);\n\nreturn [{\n  json: {\n    type: 'message_event',\n    text: textToTranslate.trim(),\n    targetLanguage: targetLang,\n    channel: event.channel,\n    user: event.user,\n    thread_ts: event.thread_ts || event.ts,\n    ts: event.ts\n  }\n}];"
      },
      "id": "16b90804-1691-4452-b183-69182fd91bce",
      "name": "Parse Slack Event",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -800,
        16
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "challenge-check",
              "leftValue": "={{ $json.isChallenge }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "7dee873d-4148-4ef0-bb28-6b29925e6660",
      "name": "Is Challenge?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -560,
        16
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ { \"challenge\": $json.challenge } }}",
        "options": {}
      },
      "id": "c2ad811a-b68d-40fe-9650-50b5468f5297",
      "name": "Return Challenge",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -352,
        -112
      ]
    },
    {
      "parameters": {
        "options": {
          "responseCode": 200
        }
      },
      "id": "12d07b94-3a1d-48a2-bc18-b33ff2b05292",
      "name": "Acknowledge Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -352,
        128
      ]
    },
    {
      "parameters": {
        "jsCode": "// Validate and map language\nconst text = $json.text || '';\nconst targetLang = ($json.targetLanguage || 'en').toLowerCase();\n\nif (!text || text.trim().length === 0) {\n  return [{\n    json: {\n      error: true,\n      errorMessage: 'âŒ No text provided for translation'\n    }\n  }];\n}\n\n// Language mapping with aliases\nconst langMap = {\n  'he': 'Hebrew', 'hebrew': 'Hebrew', '×¢×‘×¨×™×ª': 'Hebrew', 'ivrit': 'Hebrew',\n  'en': 'English', 'english': 'English', '×× ×’×œ×™×ª': 'English',\n  'ru': 'Russian', 'russian': 'Russian', '×¨×•×¡×™×ª': 'Russian', 'Ñ€ÑƒÑÑĞºĞ¸Ğ¹': 'Russian',\n  'ar': 'Arabic', 'arabic': 'Arabic', '×¢×¨×‘×™×ª': 'Arabic',\n  'es': 'Spanish', 'spanish': 'Spanish', '×¡×¤×¨×“×™×ª': 'Spanish',\n  'fr': 'French', 'french': 'French', '×¦×¨×¤×ª×™×ª': 'French',\n  'de': 'German', 'german': 'German', '×’×¨×× ×™×ª': 'German',\n  'zh': 'Chinese', 'chinese': 'Chinese', '×¡×™× ×™×ª': 'Chinese',\n  'ja': 'Japanese', 'japanese': 'Japanese', '×™×¤× ×™×ª': 'Japanese',\n  'ko': 'Korean', 'korean': 'Korean',\n  'it': 'Italian', 'italian': 'Italian',\n  'pt': 'Portuguese', 'portuguese': 'Portuguese'\n};\n\nconst targetLanguage = langMap[targetLang] || 'English';\n\nconsole.log(`Translating: \"${text.substring(0, 50)}...\" to ${targetLanguage}`);\n\nreturn [{\n  json: {\n    text: text,\n    targetLanguage: targetLanguage,\n    channel: $json.channel,\n    user: $json.user,\n    thread_ts: $json.thread_ts,\n    ts: $json.ts,\n    responseUrl: $json.responseUrl,\n    type: $json.type\n  }\n}];"
      },
      "id": "7e0b25c3-ce13-43fc-bcf1-92e82305b708",
      "name": "Validate Input",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -128,
        128
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "error-check",
              "leftValue": "={{ $json.error }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "04040b12-e9e9-4400-be9e-0aeb6cf4be6d",
      "name": "Has Error?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        96,
        128
      ]
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "={{ $json.channel }}",
          "mode": "id"
        },
        "text": "={{ $json.errorMessage }}",
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "id": "c84b1936-2d53-4725-aeaf-fcaee20bd9f6",
      "name": "Send Error to Slack",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        320,
        16
      ],
      "webhookId": "a420d641-8aa6-4e89-b0c0-071dcca0cd77",
      "credentials": {
        "slackApi": {
          "id": "DaNIVrtwfHymDT9P",
          "name": "New User"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are a professional translator. Translate the following text to {{ $json.targetLanguage }}.\n\nIMPORTANT RULES:\n1. Preserve the original meaning and tone exactly\n2. Keep all formatting (paragraphs, line breaks)\n3. Don't add explanations or commentary\n4. Output ONLY the translated text\n5. Maintain natural flow in target language\n6. For informal text, keep informal tone\n\nText to translate:\n{{ $json.text }}",
        "options": {
          "systemMessage": "You are an expert translator. Output only the translated text with no additional commentary or formatting."
        }
      },
      "id": "89d29a93-a8db-4c6b-ac89-acf84197a21c",
      "name": "AI Translation",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        320,
        256
      ]
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "google/gemma-3-27b",
          "mode": "list"
        },
        "options": {
          "maxTokens": 3000,
          "temperature": 0.3,
          "timeout": 120000,
          "topP": 0.9
        }
      },
      "id": "f9c80859-8fdd-4b22-a2dd-e68c996fbdb7",
      "name": "AI Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        224,
        416
      ],
      "credentials": {
        "openAiApi": {
          "id": "Qixf0scvpigYEtTm",
          "name": "Macbook Pro m4"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Format translation for Slack\nconst translation = $json.output || $json.text || '';\nconst originalText = $input.first().json.text || '';\nconst targetLang = $input.first().json.targetLanguage || 'Unknown';\nconst channel = $input.first().json.channel || '';\nconst thread_ts = $input.first().json.thread_ts || null;\n\n// Clean up any markdown\nlet cleanTranslation = translation\n  .replace(/^```[a-z]*\\n?/gm, '')\n  .replace(/\\n?```$/gm, '')\n  .trim();\n\n// Format for Slack with language flags\nconst langFlags = {\n  'Hebrew': 'ğŸ‡®ğŸ‡±',\n  'English': 'ğŸ‡ºğŸ‡¸',\n  'Russian': 'ğŸ‡·ğŸ‡º',\n  'Arabic': 'ğŸ‡¸ğŸ‡¦',\n  'Spanish': 'ğŸ‡ªğŸ‡¸',\n  'French': 'ğŸ‡«ğŸ‡·',\n  'German': 'ğŸ‡©ğŸ‡ª',\n  'Chinese': 'ğŸ‡¨ğŸ‡³',\n  'Japanese': 'ğŸ‡¯ğŸ‡µ',\n  'Korean': 'ğŸ‡°ğŸ‡·',\n  'Italian': 'ğŸ‡®ğŸ‡¹',\n  'Portuguese': 'ğŸ‡µğŸ‡¹'\n};\n\nconst flag = langFlags[targetLang] || 'ğŸŒ';\n\nconst slackMessage = `${flag} *Translation to ${targetLang}:*\\n${cleanTranslation}`;\n\nconsole.log('Translation completed, sending to Slack');\n\nreturn [{\n  json: {\n    text: slackMessage,\n    channel: channel,\n    thread_ts: thread_ts,\n    translation: cleanTranslation,\n    originalText: originalText,\n    targetLanguage: targetLang\n  }\n}];"
      },
      "id": "135d7c30-69ae-4639-859d-07ccb563c46e",
      "name": "Format Slack Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        256
      ]
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "={{ $json.channel }}",
          "mode": "id"
        },
        "text": "={{ $json.text }}",
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "id": "1cc57612-5ac9-495f-9502-c1d6924bf02d",
      "name": "Send Translation to Slack",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        752,
        256
      ],
      "webhookId": "a569cc07-b5bd-476f-967f-4874a48067b5",
      "credentials": {
        "slackApi": {
          "id": "DaNIVrtwfHymDT9P",
          "name": "New User"
        }
      }
    }
  ],
  "connections": {
    "Slack Webhook": {
      "main": [
        [
          {
            "node": "Parse Slack Event",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Slack Event": {
      "main": [
        [
          {
            "node": "Is Challenge?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Challenge?": {
      "main": [
        [
          {
            "node": "Return Challenge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Acknowledge Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Acknowledge Webhook": {
      "main": [
        [
          {
            "node": "Validate Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validate Input": {
      "main": [
        [
          {
            "node": "Has Error?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Error?": {
      "main": [
        [
          {
            "node": "Send Error to Slack",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Translation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Translation": {
      "main": [
        [
          {
            "node": "Format Slack Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Translation",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Format Slack Message": {
      "main": [
        [
          {
            "node": "Send Translation to Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "76c61310-3ee1-42eb-be76-60e8437638d5",
  "activeVersionId": null,
  "triggerCount": 0,
  "shared": [
    {
      "updatedAt": "2026-01-23T18:38:21.926Z",
      "createdAt": "2026-01-23T18:38:21.926Z",
      "role": "workflow:owner",
      "workflowId": "ezzdhUM8oSPHv1c6FLrie",
      "projectId": "pWTWmuHnmIHw48U9"
    }
  ],
  "activeVersion": null,
  "tags": []
}