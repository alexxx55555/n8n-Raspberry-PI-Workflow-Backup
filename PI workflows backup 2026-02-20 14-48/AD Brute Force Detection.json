{
  "updatedAt": "2026-02-20T12:43:34.277Z",
  "createdAt": "2026-02-20T12:43:29.116Z",
  "id": "RcK0xz8MHqK9Y3e7",
  "name": "AD Brute Force Detection",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "brute-force-alert",
        "options": {}
      },
      "id": "0d73d974-1c56-4da1-93e3-c0735be6cace",
      "name": "Webhook - Brute Force",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -480,
        -16
      ],
      "webhookId": "brute-force-alert"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "verify-secret",
              "leftValue": "={{ $json.body.secret }}",
              "rightValue": "n8w-GmC9x$kQ2vLpR7fT4bYe!Aj6Xs8Z",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "0894c4f1-59e1-4570-bde3-e03af65faf95",
      "name": "Verify Secret",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [
        -240,
        -16
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "target-user",
              "name": "targetUser",
              "value": "={{ $json.body.targetUser }}",
              "type": "string"
            },
            {
              "id": "display-name",
              "name": "displayName",
              "value": "={{ $json.body.displayName }}",
              "type": "string"
            },
            {
              "id": "source-ip",
              "name": "sourceIP",
              "value": "={{ $json.body.sourceIP }}",
              "type": "string"
            },
            {
              "id": "source-host",
              "name": "sourceHost",
              "value": "={{ $json.body.sourceHost }}",
              "type": "string"
            },
            {
              "id": "failure-count",
              "name": "failureCount",
              "value": "={{ $json.body.failureCount }}",
              "type": "number"
            },
            {
              "id": "failure-reason",
              "name": "failureReason",
              "value": "={{ $json.body.failureReason }}",
              "type": "string"
            },
            {
              "id": "logon-type",
              "name": "logonType",
              "value": "={{ $json.body.logonType }}",
              "type": "string"
            },
            {
              "id": "time-window",
              "name": "timeWindow",
              "value": "={{ $json.body.timeWindow }}",
              "type": "number"
            },
            {
              "id": "first-attempt",
              "name": "firstAttempt",
              "value": "={{ $json.body.firstAttempt }}",
              "type": "string"
            },
            {
              "id": "last-attempt",
              "name": "lastAttempt",
              "value": "={{ $json.body.lastAttempt }}",
              "type": "string"
            },
            {
              "id": "dc-name",
              "name": "dcName",
              "value": "={{ $json.body.dcName }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "829313a6-46d3-4293-9095-aad82bc467ec",
      "name": "Extract Alert Data",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        0,
        -16
      ]
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "#brute-force-alerts",
          "mode": "name"
        },
        "text": "=üö® *Brute Force Attack Detected*\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚Ä¢ *Target User:* {{ $json.targetUser }}{{ $json.displayName ? ' (' + $json.displayName + ')' : '' }}\n‚Ä¢ *Failed Attempts:* {{ $json.failureCount }} in {{ $json.timeWindow }} minutes\n‚Ä¢ *Failure Reason:* {{ $json.failureReason }}\n‚Ä¢ *Logon Type:* {{ $json.logonType }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚Ä¢ *Source IP:* {{ $json.sourceIP }}\n‚Ä¢ *Source Host:* {{ $json.sourceHost }}\n‚Ä¢ *First Attempt:* {{ new Date($json.firstAttempt).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.firstAttempt).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}\n‚Ä¢ *Last Attempt:* {{ new Date($json.lastAttempt).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.lastAttempt).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}\n‚Ä¢ *DC:* {{ $json.dcName }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚ö†Ô∏è _Investigate immediately ‚Äî possible credential attack_",
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "id": "a285495f-d790-4ea8-887e-f1d26079fe11",
      "name": "Slack - Brute Force Alert",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [
        240,
        -16
      ],
      "webhookId": "927e0dc4-d670-440f-9023-cbcfcfcd2106",
      "credentials": {
        "slackApi": {
          "id": "obEYVo8oQOJ22JqX",
          "name": "AD Admin Bot"
        }
      }
    }
  ],
  "connections": {
    "Webhook - Brute Force": {
      "main": [
        [
          {
            "node": "Verify Secret",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verify Secret": {
      "main": [
        [
          {
            "node": "Extract Alert Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Alert Data": {
      "main": [
        [
          {
            "node": "Slack - Brute Force Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "binaryMode": "separate",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "53c74b6e-d312-454c-a43f-310bfbfd8766",
  "activeVersionId": "53c74b6e-d312-454c-a43f-310bfbfd8766",
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2026-02-20T12:43:29.118Z",
      "createdAt": "2026-02-20T12:43:29.118Z",
      "role": "workflow:owner",
      "workflowId": "RcK0xz8MHqK9Y3e7",
      "projectId": "pWTWmuHnmIHw48U9"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-02-20T12:44:09.000Z",
    "createdAt": "2026-02-20T12:43:34.278Z",
    "versionId": "53c74b6e-d312-454c-a43f-310bfbfd8766",
    "workflowId": "RcK0xz8MHqK9Y3e7",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "brute-force-alert",
          "options": {}
        },
        "id": "0d73d974-1c56-4da1-93e3-c0735be6cace",
        "name": "Webhook - Brute Force",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -480,
          -16
        ],
        "webhookId": "brute-force-alert"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict"
            },
            "conditions": [
              {
                "id": "verify-secret",
                "leftValue": "={{ $json.body.secret }}",
                "rightValue": "n8w-GmC9x$kQ2vLpR7fT4bYe!Aj6Xs8Z",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "id": "0894c4f1-59e1-4570-bde3-e03af65faf95",
        "name": "Verify Secret",
        "type": "n8n-nodes-base.filter",
        "typeVersion": 2,
        "position": [
          -240,
          -16
        ]
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "target-user",
                "name": "targetUser",
                "value": "={{ $json.body.targetUser }}",
                "type": "string"
              },
              {
                "id": "display-name",
                "name": "displayName",
                "value": "={{ $json.body.displayName }}",
                "type": "string"
              },
              {
                "id": "source-ip",
                "name": "sourceIP",
                "value": "={{ $json.body.sourceIP }}",
                "type": "string"
              },
              {
                "id": "source-host",
                "name": "sourceHost",
                "value": "={{ $json.body.sourceHost }}",
                "type": "string"
              },
              {
                "id": "failure-count",
                "name": "failureCount",
                "value": "={{ $json.body.failureCount }}",
                "type": "number"
              },
              {
                "id": "failure-reason",
                "name": "failureReason",
                "value": "={{ $json.body.failureReason }}",
                "type": "string"
              },
              {
                "id": "logon-type",
                "name": "logonType",
                "value": "={{ $json.body.logonType }}",
                "type": "string"
              },
              {
                "id": "time-window",
                "name": "timeWindow",
                "value": "={{ $json.body.timeWindow }}",
                "type": "number"
              },
              {
                "id": "first-attempt",
                "name": "firstAttempt",
                "value": "={{ $json.body.firstAttempt }}",
                "type": "string"
              },
              {
                "id": "last-attempt",
                "name": "lastAttempt",
                "value": "={{ $json.body.lastAttempt }}",
                "type": "string"
              },
              {
                "id": "dc-name",
                "name": "dcName",
                "value": "={{ $json.body.dcName }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "id": "829313a6-46d3-4293-9095-aad82bc467ec",
        "name": "Extract Alert Data",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          0,
          -16
        ]
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "#brute-force-alerts",
            "mode": "name"
          },
          "text": "=üö® *Brute Force Attack Detected*\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚Ä¢ *Target User:* {{ $json.targetUser }}{{ $json.displayName ? ' (' + $json.displayName + ')' : '' }}\n‚Ä¢ *Failed Attempts:* {{ $json.failureCount }} in {{ $json.timeWindow }} minutes\n‚Ä¢ *Failure Reason:* {{ $json.failureReason }}\n‚Ä¢ *Logon Type:* {{ $json.logonType }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚Ä¢ *Source IP:* {{ $json.sourceIP }}\n‚Ä¢ *Source Host:* {{ $json.sourceHost }}\n‚Ä¢ *First Attempt:* {{ new Date($json.firstAttempt).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.firstAttempt).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}\n‚Ä¢ *Last Attempt:* {{ new Date($json.lastAttempt).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.lastAttempt).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}\n‚Ä¢ *DC:* {{ $json.dcName }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚ö†Ô∏è _Investigate immediately ‚Äî possible credential attack_",
          "otherOptions": {
            "includeLinkToWorkflow": false
          }
        },
        "id": "a285495f-d790-4ea8-887e-f1d26079fe11",
        "name": "Slack - Brute Force Alert",
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2.2,
        "position": [
          240,
          -16
        ],
        "webhookId": "927e0dc4-d670-440f-9023-cbcfcfcd2106",
        "credentials": {
          "slackApi": {
            "id": "obEYVo8oQOJ22JqX",
            "name": "AD Admin Bot"
          }
        }
      }
    ],
    "connections": {
      "Webhook - Brute Force": {
        "main": [
          [
            {
              "node": "Verify Secret",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Verify Secret": {
        "main": [
          [
            {
              "node": "Extract Alert Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Alert Data": {
        "main": [
          [
            {
              "node": "Slack - Brute Force Alert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Alex Vinokur",
    "name": "Version 53c74b6e",
    "description": "",
    "autosaved": true
  },
  "tags": []
}