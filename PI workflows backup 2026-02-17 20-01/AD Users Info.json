{
  "updatedAt": "2026-02-15T20:18:33.064Z",
  "createdAt": "2026-02-12T15:39:50.049Z",
  "id": "LZ8OZU5KXo6Ps6dS",
  "name": "AD Users Info",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "jsCode": "const stdout = items[0].json.stdout;\n\nif (!stdout || stdout.trim() === '') {\n  return { json: { status: 'error', message: 'No output from script' } };\n}\n\nlet parsedData = null;\n\ntry {\n  parsedData = JSON.parse(stdout);\n} catch (parseError) {\n  const jsonMatch = stdout.match(/\\{[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    try {\n      parsedData = JSON.parse(jsonMatch[0]);\n    } catch (e) {\n      return { json: { status: 'error', message: 'Failed to parse PowerShell output' } };\n    }\n  } else {\n    return { json: { status: 'error', message: 'Invalid response from AD' } };\n  }\n}\n\nreturn { json: parsedData };"
      },
      "id": "7b17b75e-852b-4192-8431-32088291017c",
      "name": "Parse AD Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        64,
        368
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json[\"status\"]}}",
              "value2": "success"
            }
          ]
        }
      },
      "id": "dd6a60f8-9c90-4a1b-81d2-ffe9401e1a0f",
      "name": "Is User Found?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        336,
        368
      ]
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C0AF1FTHEHX",
          "mode": "list",
          "cachedResultName": "ad-user-info"
        },
        "text": "=üë§ *AD User Information*\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüÜî *Username:* `{{ $json.data.username }}`\nüî¢ *Employee ID:* {{ $json.data.employeeNumber || 'N/A' }}\nüìõ *Full Name:* {{ $json.data.fullName }}\nüìß *Email:* {{ $json.data.email }}\nüìù *Description:* {{ $json.data.description || 'N/A' }}\nüíº *Title:* {{ $json.data.title }}\nüìû *Phone:* {{ $json.data.telephoneNumber || 'N/A' }}\nüëî *Manager:* {{ $json.data.manager }}\n‚öôÔ∏è *Account Enabled:* {{ $json.data.enabled ? '‚úÖ Yes' : '‚ùå No' }}\nüîê *Account Locked:* {{ $json.data.locked ? 'üîí Yes (Locked)' : 'üîì No' }}\nüïí *Last Logon:* {{ $json.data.lastLogon }}\nüîë *Password Last Set:* {{ $json.data.passwordLastSet }}\nüìÖ *Account Created:* {{ $json.data.accountCreatedDate }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìÅ *Group Memberships*\n\n‚úâÔ∏è *Distribution Groups:*\n{{ $json.data.groups.distribution.length > 0 ? $json.data.groups.distribution.map(g => `‚Ä¢ ${g}`).join('\\n') : '‚Ä¢ None' }}\n\nüõ°Ô∏è *Security Groups:*\n{{ $json.data.groups.security.length > 0 ? $json.data.groups.security.map(g => `‚Ä¢ ${g}`).join('\\n') : '‚Ä¢ None' }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n",
        "otherOptions": {}
      },
      "id": "84375761-9f99-418f-b006-985ccc0b3d17",
      "name": "Respond - User Found",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2,
      "position": [
        608,
        144
      ],
      "webhookId": "55dc93c0-d792-4d36-99f3-975e5997b9ab",
      "credentials": {
        "slackApi": {
          "id": "obEYVo8oQOJ22JqX",
          "name": "AD Admin Bot"
        }
      }
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C0AF1FTHEHX",
          "mode": "list",
          "cachedResultName": "ad-user-info"
        },
        "text": "=‚ùå *User Not Found*\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n{{ $json.message }}\n\nPlease check the username and try again.",
        "otherOptions": {}
      },
      "id": "7b95ecd8-5d96-4f28-b2e4-aa43301c6ee9",
      "name": "Respond - Not Found",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2,
      "position": [
        608,
        592
      ],
      "webhookId": "8b87b55b-8d0f-4e0a-8cf4-713ff6ecbe7d",
      "credentials": {
        "slackApi": {
          "id": "obEYVo8oQOJ22JqX",
          "name": "AD Admin Bot"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "üîç Processing request... please wait.",
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [
        -784,
        368
      ],
      "id": "a084e79d-c7fd-4693-96bb-90b0634177f4",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "command": "=powershell.exe -NoProfile -ExecutionPolicy Bypass -File \"C:\\Scripts\\Get-ADUserInfo.ps1\" -Username {{$json.user_to_search}}",
        "cwd": "="
      },
      "id": "97e865f7-770b-41c3-a7cc-a4c2943e7a60",
      "name": "SSH to AD",
      "type": "n8n-nodes-base.ssh",
      "typeVersion": 1,
      "position": [
        -224,
        368
      ],
      "credentials": {
        "sshPassword": {
          "id": "umWU43lA8b3R4GcA",
          "name": "SSH Password account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const text = items[0].json.body.text;\nreturn { user_to_search: text.trim() };"
      },
      "id": "35f3783a-d390-43ff-afce-4d7a31b69047",
      "name": "Parse Username",
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [
        -496,
        368
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "slack/get-ad-user",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "0090dd44-32ef-4141-9585-474880c8d775",
      "name": "Slack Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -1072,
        368
      ],
      "webhookId": "ad-user-lookup-webhook"
    }
  ],
  "connections": {
    "Parse AD Response": {
      "main": [
        [
          {
            "node": "Is User Found?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is User Found?": {
      "main": [
        [
          {
            "node": "Respond - User Found",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond - Not Found",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook": {
      "main": [
        [
          {
            "node": "Parse Username",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SSH to AD": {
      "main": [
        [
          {
            "node": "Parse AD Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Username": {
      "main": [
        [
          {
            "node": "SSH to AD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Slack Webhook": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "binaryMode": "separate",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "b51f8ff3-f0db-4db2-94f0-db3139f1e16b",
  "activeVersionId": "b51f8ff3-f0db-4db2-94f0-db3139f1e16b",
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2026-02-12T15:39:50.058Z",
      "createdAt": "2026-02-12T15:39:50.058Z",
      "role": "workflow:owner",
      "workflowId": "LZ8OZU5KXo6Ps6dS",
      "projectId": "pWTWmuHnmIHw48U9"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-02-15T20:18:35.000Z",
    "createdAt": "2026-02-15T20:18:33.066Z",
    "versionId": "b51f8ff3-f0db-4db2-94f0-db3139f1e16b",
    "workflowId": "LZ8OZU5KXo6Ps6dS",
    "nodes": [
      {
        "parameters": {
          "jsCode": "const stdout = items[0].json.stdout;\n\nif (!stdout || stdout.trim() === '') {\n  return { json: { status: 'error', message: 'No output from script' } };\n}\n\nlet parsedData = null;\n\ntry {\n  parsedData = JSON.parse(stdout);\n} catch (parseError) {\n  const jsonMatch = stdout.match(/\\{[\\s\\S]*\\}/);\n  if (jsonMatch) {\n    try {\n      parsedData = JSON.parse(jsonMatch[0]);\n    } catch (e) {\n      return { json: { status: 'error', message: 'Failed to parse PowerShell output' } };\n    }\n  } else {\n    return { json: { status: 'error', message: 'Invalid response from AD' } };\n  }\n}\n\nreturn { json: parsedData };"
        },
        "id": "7b17b75e-852b-4192-8431-32088291017c",
        "name": "Parse AD Response",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          64,
          368
        ]
      },
      {
        "parameters": {
          "conditions": {
            "string": [
              {
                "value1": "={{$json[\"status\"]}}",
                "value2": "success"
              }
            ]
          }
        },
        "id": "dd6a60f8-9c90-4a1b-81d2-ffe9401e1a0f",
        "name": "Is User Found?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 1,
        "position": [
          336,
          368
        ]
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "C0AF1FTHEHX",
            "mode": "list",
            "cachedResultName": "ad-user-info"
          },
          "text": "=üë§ *AD User Information*\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüÜî *Username:* `{{ $json.data.username }}`\nüî¢ *Employee ID:* {{ $json.data.employeeNumber || 'N/A' }}\nüìõ *Full Name:* {{ $json.data.fullName }}\nüìß *Email:* {{ $json.data.email }}\nüìù *Description:* {{ $json.data.description || 'N/A' }}\nüíº *Title:* {{ $json.data.title }}\nüìû *Phone:* {{ $json.data.telephoneNumber || 'N/A' }}\nüëî *Manager:* {{ $json.data.manager }}\n‚öôÔ∏è *Account Enabled:* {{ $json.data.enabled ? '‚úÖ Yes' : '‚ùå No' }}\nüîê *Account Locked:* {{ $json.data.locked ? 'üîí Yes (Locked)' : 'üîì No' }}\nüïí *Last Logon:* {{ $json.data.lastLogon }}\nüîë *Password Last Set:* {{ $json.data.passwordLastSet }}\nüìÖ *Account Created:* {{ $json.data.accountCreatedDate }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìÅ *Group Memberships*\n\n‚úâÔ∏è *Distribution Groups:*\n{{ $json.data.groups.distribution.length > 0 ? $json.data.groups.distribution.map(g => `‚Ä¢ ${g}`).join('\\n') : '‚Ä¢ None' }}\n\nüõ°Ô∏è *Security Groups:*\n{{ $json.data.groups.security.length > 0 ? $json.data.groups.security.map(g => `‚Ä¢ ${g}`).join('\\n') : '‚Ä¢ None' }}\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n",
          "otherOptions": {}
        },
        "id": "84375761-9f99-418f-b006-985ccc0b3d17",
        "name": "Respond - User Found",
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2,
        "position": [
          608,
          144
        ],
        "webhookId": "55dc93c0-d792-4d36-99f3-975e5997b9ab",
        "credentials": {
          "slackApi": {
            "id": "obEYVo8oQOJ22JqX",
            "name": "AD Admin Bot"
          }
        }
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "C0AF1FTHEHX",
            "mode": "list",
            "cachedResultName": "ad-user-info"
          },
          "text": "=‚ùå *User Not Found*\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n{{ $json.message }}\n\nPlease check the username and try again.",
          "otherOptions": {}
        },
        "id": "7b95ecd8-5d96-4f28-b2e4-aa43301c6ee9",
        "name": "Respond - Not Found",
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2,
        "position": [
          608,
          592
        ],
        "webhookId": "8b87b55b-8d0f-4e0a-8cf4-713ff6ecbe7d",
        "credentials": {
          "slackApi": {
            "id": "obEYVo8oQOJ22JqX",
            "name": "AD Admin Bot"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "text",
          "responseBody": "üîç Processing request... please wait.",
          "options": {}
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.5,
        "position": [
          -784,
          368
        ],
        "id": "a084e79d-c7fd-4693-96bb-90b0634177f4",
        "name": "Respond to Webhook"
      },
      {
        "parameters": {
          "command": "=powershell.exe -NoProfile -ExecutionPolicy Bypass -File \"C:\\Scripts\\Get-ADUserInfo.ps1\" -Username {{$json.user_to_search}}",
          "cwd": "="
        },
        "id": "97e865f7-770b-41c3-a7cc-a4c2943e7a60",
        "name": "SSH to AD",
        "type": "n8n-nodes-base.ssh",
        "typeVersion": 1,
        "position": [
          -224,
          368
        ],
        "credentials": {
          "sshPassword": {
            "id": "umWU43lA8b3R4GcA",
            "name": "SSH Password account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "const text = items[0].json.body.text;\nreturn { user_to_search: text.trim() };"
        },
        "id": "35f3783a-d390-43ff-afce-4d7a31b69047",
        "name": "Parse Username",
        "type": "n8n-nodes-base.code",
        "typeVersion": 1,
        "position": [
          -496,
          368
        ]
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "slack/get-ad-user",
          "responseMode": "responseNode",
          "options": {}
        },
        "id": "0090dd44-32ef-4141-9585-474880c8d775",
        "name": "Slack Webhook",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 1,
        "position": [
          -1072,
          368
        ],
        "webhookId": "ad-user-lookup-webhook"
      }
    ],
    "connections": {
      "Parse AD Response": {
        "main": [
          [
            {
              "node": "Is User Found?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is User Found?": {
        "main": [
          [
            {
              "node": "Respond - User Found",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Respond - Not Found",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Respond to Webhook": {
        "main": [
          [
            {
              "node": "Parse Username",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "SSH to AD": {
        "main": [
          [
            {
              "node": "Parse AD Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Username": {
        "main": [
          [
            {
              "node": "SSH to AD",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Slack Webhook": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Alex Vinokur",
    "name": "Version b51f8ff3",
    "description": "",
    "autosaved": true
  },
  "tags": []
}