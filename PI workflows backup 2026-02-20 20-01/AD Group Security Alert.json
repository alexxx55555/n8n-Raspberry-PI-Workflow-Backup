{
  "updatedAt": "2026-02-20T10:09:41.106Z",
  "createdAt": "2026-02-19T16:22:28.652Z",
  "id": "uyiPDLjeIQmcJtqM",
  "name": "AD Group Security Alert",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "group-membership-change",
        "options": {}
      },
      "id": "511369a8-de2e-4899-8e90-5c190929a4f7",
      "name": "Webhook - Receive DC Event",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -1360,
        -256
      ],
      "webhookId": "group-membership-change"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "verify-secret",
              "leftValue": "={{ $json.body.secret }}",
              "rightValue": "n8w-GmC9x$kQ2vLpR7fT4bYe!Aj6Xs8Z",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "1eba1052-6338-4bd2-b825-3def4671a002",
      "name": "Verify Shared Secret",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [
        -1088,
        -256
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "action-type",
              "name": "actionType",
              "value": "={{ $json.body.actionType }}",
              "type": "string"
            },
            {
              "id": "affected-user",
              "name": "affectedUser",
              "value": "={{ $json.body.affectedUser }}",
              "type": "string"
            },
            {
              "id": "9ef89254-2591-48a7-91dd-2b0d3d0d8d0d",
              "name": "affectedDisplayName",
              "value": "={{ $json.body.affectedDisplayName }}",
              "type": "string"
            },
            {
              "id": "group-name",
              "name": "groupName",
              "value": "={{ $json.body.groupName }}",
              "type": "string"
            },
            {
              "id": "group-domain",
              "name": "groupDomain",
              "value": "={{ $json.body.groupDomain }}",
              "type": "string"
            },
            {
              "id": "performed-by",
              "name": "performedBy",
              "value": "={{ $json.body.performedBy }}",
              "type": "string"
            },
            {
              "id": "event-id",
              "name": "eventId",
              "value": "={{ $json.body.eventId }}",
              "type": "number"
            },
            {
              "id": "timestamp",
              "name": "timestamp",
              "value": "={{ $json.body.timestamp }}",
              "type": "string"
            },
            {
              "id": "dc-name",
              "name": "dcName",
              "value": "={{ $json.body.dcName }}",
              "type": "string"
            },
            {
              "id": "auto-disabled",
              "name": "autoDisabled",
              "value": "={{ $json.body.autoDisabled }}",
              "type": "boolean"
            },
            {
              "id": "auto-disable-error",
              "name": "autoDisableError",
              "value": "={{ $json.body.autoDisableError }}",
              "type": "string"
            },
            {
              "id": "event-type-label",
              "name": "eventTypeLabel",
              "value": "={{ {4728: 'Global Group', 4732: 'Local Group', 4756: 'Universal Group', 4729: 'Global Group', 4733: 'Local Group', 4757: 'Universal Group'}[$json.body.eventId] || 'Unknown' }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "68c0de24-019a-4c4f-a7df-30fecbc0ee58",
      "name": "Extract Event Details",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -832,
        -256
      ]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 1
          },
          "conditions": [
            {
              "id": "sensitive-group-check",
              "leftValue": "={{ $json.groupName }}",
              "rightValue": "Domain Admins,Enterprise Admins,Schema Admins,Administrators",
              "operator": {
                "type": "string",
                "operation": "in"
              }
            },
            {
              "id": "55186ca6-d72c-43d4-9d21-5650d98fb09c",
              "leftValue": "={{ ['Domain Admins','Enterprise Admins','Schema Admins','Administrators','Security Group'].includes($json.groupName) }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "b3d598fd-08f4-4f81-84dd-7a5d62fa68dd",
      "name": "Filter: Sensitive Groups Only",
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2,
      "position": [
        -608,
        -256
      ]
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.actionType }}",
                    "rightValue": "MEMBER_ADDED",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "930b2cff-874a-4a87-8378-a3b07bad4b88"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.actionType }}",
                    "rightValue": "MEMBER_REMOVED",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "98035e87-8f26-4d5c-aa60-f5961a7c5d72"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "e53ef75b-3218-40b0-b1fb-ebb8b1298cc0",
      "name": "Switch: Add or Remove",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -320,
        -256
      ]
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "#security-alerts",
          "mode": "name"
        },
        "text": "=ðŸ”´ *SENSITIVE GROUP â€” Member Added*\n\nâ€¢ *User:* {{ $json.affectedUser }}\nâ€¢ *Name:* {{ $json.affectedDisplayName || 'N/A' }}\nâ€¢ *Group:* {{ $json.groupName }} ({{ $json.eventTypeLabel }})\nâ€¢ *Domain:* {{ $json.groupDomain }}\nâ€¢ *DC:* {{ $json.dcName }}\nâ€¢ *Event ID:* {{ $json.eventId }}\nâ€¢ *Performed By:* {{ $json.performedBy }}\nâ€¢ *Time:* {{ new Date($json.timestamp).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.timestamp).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}",
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "id": "e70fd7db-eea3-4223-a315-c372d932acc5",
      "name": "Slack - Member Added Alert",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [
        16,
        -352
      ],
      "webhookId": "435bf4be-6b91-4e93-b0fe-9556e95d97a6",
      "credentials": {
        "slackApi": {
          "id": "6ZeCMu3zrEgj1Omk",
          "name": "Secuiry Alert"
        }
      }
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "#security-alerts",
          "mode": "name"
        },
        "text": "=ðŸŸ¢ *SENSITIVE GROUP â€” Member Removed*\n\nâ€¢ *User:* {{ $json.affectedUser }}\nâ€¢ *Name:* {{ $json.affectedDisplayName || 'N/A' }}\nâ€¢ *Group:* {{ $json.groupName }} ({{ $json.eventTypeLabel }})\nâ€¢ *Domain:* {{ $json.groupDomain }}\nâ€¢ *DC:* {{ $json.dcName }}\nâ€¢ *Event ID:* {{ $json.eventId }}\nâ€¢ *Performed By:* {{ $json.performedBy }}\nâ€¢ *Time:* {{ new Date($json.timestamp).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.timestamp).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}",
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "id": "0e51c7d1-5d82-4612-917e-fb78b7c1bf7a",
      "name": "Slack - Member Removed Alert",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.2,
      "position": [
        16,
        -128
      ],
      "webhookId": "43db61e2-7cee-4b68-8c3a-8800d98f1acc",
      "credentials": {
        "slackApi": {
          "id": "6ZeCMu3zrEgj1Omk",
          "name": "Secuiry Alert"
        }
      }
    }
  ],
  "connections": {
    "Webhook - Receive DC Event": {
      "main": [
        [
          {
            "node": "Verify Shared Secret",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Verify Shared Secret": {
      "main": [
        [
          {
            "node": "Extract Event Details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Event Details": {
      "main": [
        [
          {
            "node": "Filter: Sensitive Groups Only",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter: Sensitive Groups Only": {
      "main": [
        [
          {
            "node": "Switch: Add or Remove",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch: Add or Remove": {
      "main": [
        [
          {
            "node": "Slack - Member Added Alert",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Slack - Member Removed Alert",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "binaryMode": "separate",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "0fd1fcb0-4e4d-455a-96c3-ca64eab19907",
  "activeVersionId": "0fd1fcb0-4e4d-455a-96c3-ca64eab19907",
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2026-02-19T16:22:28.659Z",
      "createdAt": "2026-02-19T16:22:28.659Z",
      "role": "workflow:owner",
      "workflowId": "uyiPDLjeIQmcJtqM",
      "projectId": "pWTWmuHnmIHw48U9"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-02-20T10:08:28.000Z",
    "createdAt": "2026-02-20T10:08:25.133Z",
    "versionId": "0fd1fcb0-4e4d-455a-96c3-ca64eab19907",
    "workflowId": "uyiPDLjeIQmcJtqM",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "group-membership-change",
          "options": {}
        },
        "id": "511369a8-de2e-4899-8e90-5c190929a4f7",
        "name": "Webhook - Receive DC Event",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -1360,
          -256
        ],
        "webhookId": "group-membership-change"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "id": "verify-secret",
                "leftValue": "={{ $json.body.secret }}",
                "rightValue": "n8w-GmC9x$kQ2vLpR7fT4bYe!Aj6Xs8Z",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "id": "1eba1052-6338-4bd2-b825-3def4671a002",
        "name": "Verify Shared Secret",
        "type": "n8n-nodes-base.filter",
        "typeVersion": 2,
        "position": [
          -1088,
          -256
        ]
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "action-type",
                "name": "actionType",
                "value": "={{ $json.body.actionType }}",
                "type": "string"
              },
              {
                "id": "affected-user",
                "name": "affectedUser",
                "value": "={{ $json.body.affectedUser }}",
                "type": "string"
              },
              {
                "id": "9ef89254-2591-48a7-91dd-2b0d3d0d8d0d",
                "name": "affectedDisplayName",
                "value": "={{ $json.body.affectedDisplayName }}",
                "type": "string"
              },
              {
                "id": "group-name",
                "name": "groupName",
                "value": "={{ $json.body.groupName }}",
                "type": "string"
              },
              {
                "id": "group-domain",
                "name": "groupDomain",
                "value": "={{ $json.body.groupDomain }}",
                "type": "string"
              },
              {
                "id": "performed-by",
                "name": "performedBy",
                "value": "={{ $json.body.performedBy }}",
                "type": "string"
              },
              {
                "id": "event-id",
                "name": "eventId",
                "value": "={{ $json.body.eventId }}",
                "type": "number"
              },
              {
                "id": "timestamp",
                "name": "timestamp",
                "value": "={{ $json.body.timestamp }}",
                "type": "string"
              },
              {
                "id": "dc-name",
                "name": "dcName",
                "value": "={{ $json.body.dcName }}",
                "type": "string"
              },
              {
                "id": "auto-disabled",
                "name": "autoDisabled",
                "value": "={{ $json.body.autoDisabled }}",
                "type": "boolean"
              },
              {
                "id": "auto-disable-error",
                "name": "autoDisableError",
                "value": "={{ $json.body.autoDisableError }}",
                "type": "string"
              },
              {
                "id": "event-type-label",
                "name": "eventTypeLabel",
                "value": "={{ {4728: 'Global Group', 4732: 'Local Group', 4756: 'Universal Group', 4729: 'Global Group', 4733: 'Local Group', 4757: 'Universal Group'}[$json.body.eventId] || 'Unknown' }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "id": "68c0de24-019a-4c4f-a7df-30fecbc0ee58",
        "name": "Extract Event Details",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -832,
          -256
        ]
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "id": "sensitive-group-check",
                "leftValue": "={{ $json.groupName }}",
                "rightValue": "Domain Admins,Enterprise Admins,Schema Admins,Administrators",
                "operator": {
                  "type": "string",
                  "operation": "in"
                }
              },
              {
                "id": "55186ca6-d72c-43d4-9d21-5650d98fb09c",
                "leftValue": "={{ ['Domain Admins','Enterprise Admins','Schema Admins','Administrators','Security Group'].includes($json.groupName) }}",
                "rightValue": "",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                }
              }
            ],
            "combinator": "or"
          },
          "options": {}
        },
        "id": "b3d598fd-08f4-4f81-84dd-7a5d62fa68dd",
        "name": "Filter: Sensitive Groups Only",
        "type": "n8n-nodes-base.filter",
        "typeVersion": 2,
        "position": [
          -608,
          -256
        ]
      },
      {
        "parameters": {
          "rules": {
            "values": [
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.actionType }}",
                      "rightValue": "MEMBER_ADDED",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "930b2cff-874a-4a87-8378-a3b07bad4b88"
                    }
                  ],
                  "combinator": "and"
                }
              },
              {
                "conditions": {
                  "options": {
                    "caseSensitive": true,
                    "leftValue": "",
                    "typeValidation": "strict",
                    "version": 2
                  },
                  "conditions": [
                    {
                      "leftValue": "={{ $json.actionType }}",
                      "rightValue": "MEMBER_REMOVED",
                      "operator": {
                        "type": "string",
                        "operation": "equals"
                      },
                      "id": "98035e87-8f26-4d5c-aa60-f5961a7c5d72"
                    }
                  ],
                  "combinator": "and"
                }
              }
            ]
          },
          "options": {}
        },
        "id": "e53ef75b-3218-40b0-b1fb-ebb8b1298cc0",
        "name": "Switch: Add or Remove",
        "type": "n8n-nodes-base.switch",
        "typeVersion": 3.2,
        "position": [
          -320,
          -256
        ]
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "#security-alerts",
            "mode": "name"
          },
          "text": "=ðŸ”´ *SENSITIVE GROUP â€” Member Added*\n\nâ€¢ *User:* {{ $json.affectedUser }}\nâ€¢ *Name:* {{ $json.affectedDisplayName || 'N/A' }}\nâ€¢ *Group:* {{ $json.groupName }} ({{ $json.eventTypeLabel }})\nâ€¢ *Domain:* {{ $json.groupDomain }}\nâ€¢ *DC:* {{ $json.dcName }}\nâ€¢ *Event ID:* {{ $json.eventId }}\nâ€¢ *Performed By:* {{ $json.performedBy }}\nâ€¢ *Time:* {{ new Date($json.timestamp).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.timestamp).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}",
          "otherOptions": {
            "includeLinkToWorkflow": false
          }
        },
        "id": "e70fd7db-eea3-4223-a315-c372d932acc5",
        "name": "Slack - Member Added Alert",
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2.2,
        "position": [
          16,
          -352
        ],
        "webhookId": "435bf4be-6b91-4e93-b0fe-9556e95d97a6",
        "credentials": {
          "slackApi": {
            "id": "6ZeCMu3zrEgj1Omk",
            "name": "Secuiry Alert"
          }
        }
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "#security-alerts",
            "mode": "name"
          },
          "text": "=ðŸŸ¢ *SENSITIVE GROUP â€” Member Removed*\n\nâ€¢ *User:* {{ $json.affectedUser }}\nâ€¢ *Name:* {{ $json.affectedDisplayName || 'N/A' }}\nâ€¢ *Group:* {{ $json.groupName }} ({{ $json.eventTypeLabel }})\nâ€¢ *Domain:* {{ $json.groupDomain }}\nâ€¢ *DC:* {{ $json.dcName }}\nâ€¢ *Event ID:* {{ $json.eventId }}\nâ€¢ *Performed By:* {{ $json.performedBy }}\nâ€¢ *Time:* {{ new Date($json.timestamp).toLocaleDateString('en-GB', {day:'numeric',month:'numeric',year:'numeric'}) + ' ' + new Date($json.timestamp).toLocaleTimeString('en-US', {hour:'numeric',minute:'2-digit',hour12:true}) }}",
          "otherOptions": {
            "includeLinkToWorkflow": false
          }
        },
        "id": "0e51c7d1-5d82-4612-917e-fb78b7c1bf7a",
        "name": "Slack - Member Removed Alert",
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2.2,
        "position": [
          16,
          -128
        ],
        "webhookId": "43db61e2-7cee-4b68-8c3a-8800d98f1acc",
        "credentials": {
          "slackApi": {
            "id": "6ZeCMu3zrEgj1Omk",
            "name": "Secuiry Alert"
          }
        }
      }
    ],
    "connections": {
      "Webhook - Receive DC Event": {
        "main": [
          [
            {
              "node": "Verify Shared Secret",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Verify Shared Secret": {
        "main": [
          [
            {
              "node": "Extract Event Details",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Event Details": {
        "main": [
          [
            {
              "node": "Filter: Sensitive Groups Only",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Filter: Sensitive Groups Only": {
        "main": [
          [
            {
              "node": "Switch: Add or Remove",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Switch: Add or Remove": {
        "main": [
          [
            {
              "node": "Slack - Member Added Alert",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Slack - Member Removed Alert",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Alex Vinokur",
    "name": "Version 0fd1fcb0",
    "description": "",
    "autosaved": true
  },
  "tags": []
}