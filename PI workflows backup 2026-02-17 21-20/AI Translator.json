{
  "updatedAt": "2026-02-17T19:18:30.299Z",
  "createdAt": "2026-01-23T18:38:21.921Z",
  "id": "ezzdhUM8oSPHv1c6FLrie",
  "name": "AI Translator",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "slack-interactive",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "d4cebd4a-7b72-429a-a4e7-104ea5c15d53",
      "name": "ğŸ”˜ Button Click Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -144,
        -592
      ],
      "webhookId": "slack-interactive",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Parse Slack interactive payload\nconst body = $input.first().json.body;\nconst payload = JSON.parse(body.payload);\n\n// Case 1: Triggered via the \"Translate this\" menu shortcut\nif (payload.type === 'message_action') {\n  return {\n    json: {\n      text: payload.message.text,\n      target_language: 'en', // Default to English for shortcuts\n      source_language: 'auto',\n      response_url: payload.response_url,\n      user_id: payload.user.id,\n      user_name: payload.user.name,\n      trigger_type: 'shortcut'\n    }\n  };\n}\n\n// Case 2: Triggered via a button click (your current logic)\nconst value = payload.actions[0].value;\nconst parts = value.split('|');\n\nreturn {\n  json: {\n    target_language: parts[0],\n    source_language: parts[1],\n    text: parts.slice(2).join('|'),\n    response_url: payload.response_url,\n    user_id: payload.user.id,\n    user_name: payload.user.name,\n    trigger_type: 'button'\n  }\n};"
      },
      "id": "7520e4e3-476a-423f-9540-8b8faf1a14ed",
      "name": "ğŸ“‹ Parse Button Click",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        96,
        -592
      ],
      "disabled": true
    },
    {
      "parameters": {
        "options": {
          "responseCode": 200
        }
      },
      "id": "44c119b4-ec2c-4786-988d-5c12d221bdc7",
      "name": "âš¡ ACK Button",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        336,
        -592
      ],
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.response_url }}",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "replace_original",
              "value": "true"
            },
            {
              "name": "text",
              "value": "=â³ Translating to {{ $json.target_language }}..."
            }
          ]
        },
        "options": {}
      },
      "id": "100b0b06-5b68-4640-b971-a78e541dcece",
      "name": "â³ Show Translating",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        576,
        -592
      ],
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "const response = $input.first().json.output;\nconst inputData = $node[\"ğŸ“‹ Parse Button Click\"].json;\n\n// Updated Flag Map: en is now US flag\nconst flags = {\n  en: \"ğŸ‡ºğŸ‡¸\", fr: \"ğŸ‡«ğŸ‡·\", es: \"ğŸ‡ªğŸ‡¸\", de: \"ğŸ‡©ğŸ‡ª\",\n  he: \"ğŸ‡®ğŸ‡±\", ar: \"ğŸ‡¸ğŸ‡¦\", ja: \"ğŸ‡¯ğŸ‡µ\", zh: \"ğŸ‡¨ğŸ‡³\",\n  ru: \"ğŸ‡·ğŸ‡º\", it: \"ğŸ‡®ğŸ‡¹\", pt: \"ğŸ‡µğŸ‡¹\", ko: \"ğŸ‡°ğŸ‡·\"\n};\n\nconst langNames = {\n  en: \"English\", fr: \"French\", es: \"Spanish\", de: \"German\",\n  he: \"Hebrew\", ar: \"Arabic\", ja: \"Japanese\", zh: \"Chinese\",\n  ru: \"Russian\", it: \"Italian\", pt: \"Portuguese\", ko: \"Korean\"\n};\n\nconst rtlLangs = [\"he\", \"ar\"];\n\ntry {\n  const start = response.indexOf('{');\n  const end = response.lastIndexOf('}') + 1;\n  if (start === -1 || end === 0) throw new Error(\"No JSON found\");\n\n  const parsed = JSON.parse(response.slice(start, end));\n  let translation = parsed.translation || \"(Translation missing)\";\n\n  if (rtlLangs.includes(inputData.target_language)) {\n    translation = `\\u202B${translation}\\u202C`;\n  }\n\n  return {\n    json: {\n      detected_language_name: langNames[inputData.source_language] || inputData.source_language,\n      target_language_name: langNames[inputData.target_language] || inputData.target_language,\n      source_flag: flags[inputData.source_language] || \"ğŸŒ\",\n      target_flag: flags[inputData.target_language] || \"ğŸŒ\",\n      flag: flags[inputData.target_language] || \"ğŸŒ\", // Backward compatibility for existing blocks\n      original_text: inputData.text,\n      formatted_translation: translation,\n      response_url: inputData.response_url\n    }\n  };\n} catch (error) {\n  return { json: { formatted_translation: \"âŒ Error: \" + error.message, source_flag: \"âš ï¸\", target_flag: \"âš ï¸\" } };\n}"
      },
      "id": "0d76294e-e751-408b-87ce-33e7f73eb8fe",
      "name": "âœ… Parse Translation",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1152,
        -592
      ],
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.response_url }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"replace_original\": true,\n  \"blocks\": [\n    {\n      \"type\": \"header\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"ğŸŒ Translation Complete\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*ğŸ“ Original ({{ $json.source_flag }} {{ $json.detected_language_name }}):*\\n```{{ $json.original_text }}```\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*{{ $json.target_flag }} {{ $json.target_language_name }} Translation:*\\n```{{ $json.formatted_translation }}```\"\n      }\n    }\n  ]\n}",
        "options": {}
      },
      "id": "87b8212e-5066-4d43-bb41-6ede5e2d635b",
      "name": "âœ… Send Translation Result",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1360,
        -592
      ],
      "disabled": true
    },
    {
      "parameters": {
        "model": "openai/gpt-5-nano",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        896,
        -336
      ],
      "id": "1244af55-5a15-4df5-83a5-37d48ef07975",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "hGAnvpSAhWRbFktq",
          "name": "OpenRouter account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "model": "openai/gpt-5-nano",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        688,
        -832
      ],
      "id": "053a874c-c8db-4bea-9946-fdb8c72547a4",
      "name": "OpenRouter Chat Model1",
      "credentials": {
        "openRouterApi": {
          "id": "hGAnvpSAhWRbFktq",
          "name": "OpenRouter account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "google/gemma-3-27b",
          "mode": "list",
          "cachedResultName": "google/gemma-3-27b"
        },
        "options": {
          "frequencyPenalty": 0.3,
          "maxTokens": 1000,
          "presencePenalty": 0.1,
          "temperature": 0.1,
          "timeout": 60000,
          "topP": 0.9
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        464,
        -832
      ],
      "id": "4c37f41d-a057-4052-9f92-60f3b7a2e652",
      "name": "ğŸ¤– LLM (Detect)",
      "credentials": {
        "openAiApi": {
          "id": "WJsCuec8UzGRGVIc",
          "name": "Macbook ProM1 Pro"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "translate",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "a82220a2-2529-4eb0-8548-63e084dcee8f",
      "name": "ğŸ¯ Slack Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -144,
        -1040
      ],
      "webhookId": "translate-webhook",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "// Extract data from Slack slash command\nconst body = $input.first().json.body;\nconst text = body.text ? body.text.trim() : 'No text provided';\n\nreturn {\n  json: {\n    text: text,\n    user_id: body.user_id || 'unknown',\n    user_name: body.user_name || 'unknown',\n    channel_id: body.channel_id || 'unknown',\n    response_url: body.response_url || null\n  }\n};"
      },
      "id": "01d857f8-0fb2-4538-83b0-aaa7bb05c8c0",
      "name": "ğŸ“‹ Parse Input",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        96,
        -1040
      ],
      "disabled": true
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "e8549515-b2a0-4eab-9fb4-4086f2515cd1",
      "name": "âš¡ Immediate Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        336,
        -1040
      ],
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Detect the language of this text and return ONLY a JSON object:\n\n{\n  \"language_code\": \"<ISO 639-1 code>\",\n  \"language_name\": \"<Full language name>\",\n  \"confidence\": \"high|medium|low\"\n}\n\nText: {{ $json.text }}",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are a language detection AI. Always output valid JSON only."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        576,
        -1040
      ],
      "id": "234b3630-11d4-4f68-a3cb-02569d446fc5",
      "name": "ğŸ” Detect Language",
      "disabled": true
    },
    {
      "parameters": {
        "jsCode": "const response = $input.first().json.output;\nconst inputData = $node[\"ğŸ“‹ Parse Input\"].json;\n\ntry {\n  const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n  const parsed = JSON.parse(jsonMatch[0]);\n  \n  return {\n    json: {\n      text: inputData.text,\n      detected_language: parsed.language_code,\n      detected_language_name: parsed.language_name,\n      response_url: inputData.response_url,\n      user_id: inputData.user_id,\n      user_name: inputData.user_name\n    }\n  };\n} catch (error) {\n  return {\n    json: {\n      text: inputData.text,\n      detected_language: 'en',\n      detected_language_name: 'English',\n      response_url: inputData.response_url,\n      user_id: inputData.user_id,\n      user_name: inputData.user_name\n    }\n  };\n}"
      },
      "id": "a5eecb62-2105-49d4-b2a8-d739507a6711",
      "name": "Parse Detection",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        928,
        -1040
      ],
      "disabled": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.response_url }}",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "replace_original",
              "value": "true"
            },
            {
              "name": "text",
              "value": "=ğŸŒ *Translate Text*\n\nğŸ“ Original ({{ $json.detected_language_name }}):\n`{{ $json.text }}`\n\nğŸ‘‡ *Choose a language to translate to:*"
            },
            {
              "name": "blocks",
              "value": "=[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"ğŸŒ *Translate Text*\\n\\nğŸ“ Original ({{ $json.detected_language_name }}): `{{ $json.text }}`\\n\\nğŸ‘‡ *Choose a language to translate to:*\"\n    }\n  },\n  {\n    \"type\": \"actions\",\n    \"block_id\": \"lang_select\",\n    \"elements\": [\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ºğŸ‡¸ English\", \"emoji\": true },\n        \"value\": \"en|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_en\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡«ğŸ‡· French\", \"emoji\": true },\n        \"value\": \"fr|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_fr\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ªğŸ‡¸ Spanish\", \"emoji\": true },\n        \"value\": \"es|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_es\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡©ğŸ‡ª German\", \"emoji\": true },\n        \"value\": \"de|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_de\"\n      }\n    ]\n  },\n  {\n    \"type\": \"actions\",\n    \"block_id\": \"lang_select_2\",\n    \"elements\": [\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡± Hebrew\", \"emoji\": true },\n        \"value\": \"he|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_he\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¸ğŸ‡¦ Arabic\", \"emoji\": true },\n        \"value\": \"ar|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ar\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¯ğŸ‡µ Japanese\", \"emoji\": true },\n        \"value\": \"ja|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ja\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¨ğŸ‡³ Chinese\", \"emoji\": true },\n        \"value\": \"zh|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_zh\"\n      }\n    ]\n  },\n  {\n    \"type\": \"actions\",\n    \"block_id\": \"lang_select_3\",\n    \"elements\": [\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡·ğŸ‡º Russian\", \"emoji\": true },\n        \"value\": \"ru|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ru\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡¹ Italian\", \"emoji\": true },\n        \"value\": \"it|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_it\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡µğŸ‡¹ Portuguese\", \"emoji\": true },\n        \"value\": \"pt|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_pt\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡°ğŸ‡· Korean\", \"emoji\": true },\n        \"value\": \"ko|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ko\"\n      }\n    ]\n  }\n]"
            }
          ]
        },
        "options": {}
      },
      "id": "473c2777-b776-4c58-9c1e-3d19117c7943",
      "name": "ğŸ›ï¸ Show Language Buttons",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1184,
        -1040
      ],
      "disabled": true
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=TASK: Translate the provided text.\nTARGET LANGUAGE: {{ $node[\"ğŸ“‹ Parse Button Click\"].json.target_language }}\nSOURCE LANGUAGE: {{ $node[\"ğŸ“‹ Parse Button Click\"].json.source_language }}\n\nINPUT TEXT:\n{{ $node[\"ğŸ“‹ Parse Button Click\"].json.text }}\n\nOUTPUT FORMAT (Return ONLY raw JSON):\n{\n  \"detected_language\": \"{{ $node[\"ğŸ“‹ Parse Button Click\"].json.source_language }}\",\n  \"target_language\": \"{{ $node[\"ğŸ“‹ Parse Button Click\"].json.target_language }}\",\n  \"translation\": \"...\"\n}\n\nCRITICAL: \n1. Do not include markdown formatting like ```json.\n2. Only translate the \"translation\" value.\n3. Do not add any conversational text.",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are a translation API. Output only valid JSON. Never add extra text."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        816,
        -592
      ],
      "id": "bd2b1429-7d56-4ef8-b18f-aa23f640f296",
      "name": "ğŸŒ AI Translator",
      "disabled": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "qwen/qwen3-coder-30b",
          "mode": "list",
          "cachedResultName": "qwen/qwen3-coder-30b"
        },
        "options": {
          "frequencyPenalty": 0.3,
          "maxTokens": 500,
          "presencePenalty": 0.1,
          "temperature": 0,
          "timeout": 120000,
          "topP": 0.8
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        656,
        -336
      ],
      "id": "8091f806-c86e-4e37-97cf-cbb2c785bc3e",
      "name": "ğŸ¤– LLM (Translate",
      "credentials": {
        "openAiApi": {
          "id": "WJsCuec8UzGRGVIc",
          "name": "Macbook ProM1 Pro"
        }
      },
      "disabled": true
    }
  ],
  "connections": {
    "ğŸ”˜ Button Click Webhook": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Parse Button Click",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Parse Button Click": {
      "main": [
        [
          {
            "node": "âš¡ ACK Button",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš¡ ACK Button": {
      "main": [
        [
          {
            "node": "â³ Show Translating",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â³ Show Translating": {
      "main": [
        [
          {
            "node": "ğŸŒ AI Translator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ… Parse Translation": {
      "main": [
        [
          {
            "node": "âœ… Send Translation Result",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸŒ AI Translator",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ” Detect Language",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "ğŸ¤– LLM (Detect)": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸ” Detect Language",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¯ Slack Webhook": {
      "main": [
        [
          {
            "node": "ğŸ“‹ Parse Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Parse Input": {
      "main": [
        [
          {
            "node": "âš¡ Immediate Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âš¡ Immediate Response": {
      "main": [
        [
          {
            "node": "ğŸ” Detect Language",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Detect Language": {
      "main": [
        [
          {
            "node": "Parse Detection",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Detection": {
      "main": [
        [
          {
            "node": "ğŸ›ï¸ Show Language Buttons",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸŒ AI Translator": {
      "main": [
        [
          {
            "node": "âœ… Parse Translation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– LLM (Translate": {
      "ai_languageModel": [
        [
          {
            "node": "ğŸŒ AI Translator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "3684c950-5011-431c-a031-c8c7e455721f",
  "activeVersionId": "ed275c11-9536-4dcc-b473-b857b47fac2b",
  "triggerCount": 2,
  "shared": [
    {
      "updatedAt": "2026-01-23T18:38:21.926Z",
      "createdAt": "2026-01-23T18:38:21.926Z",
      "role": "workflow:owner",
      "workflowId": "ezzdhUM8oSPHv1c6FLrie",
      "projectId": "pWTWmuHnmIHw48U9"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-02-17T19:16:14.000Z",
    "createdAt": "2026-02-17T19:16:13.060Z",
    "versionId": "ed275c11-9536-4dcc-b473-b857b47fac2b",
    "workflowId": "ezzdhUM8oSPHv1c6FLrie",
    "nodes": [
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "slack-interactive",
          "responseMode": "responseNode",
          "options": {}
        },
        "id": "d4cebd4a-7b72-429a-a4e7-104ea5c15d53",
        "name": "ğŸ”˜ Button Click Webhook",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -144,
          -592
        ],
        "webhookId": "slack-interactive",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Parse Slack interactive payload\nconst body = $input.first().json.body;\nconst payload = JSON.parse(body.payload);\n\n// Case 1: Triggered via the \"Translate this\" menu shortcut\nif (payload.type === 'message_action') {\n  return {\n    json: {\n      text: payload.message.text,\n      target_language: 'en', // Default to English for shortcuts\n      source_language: 'auto',\n      response_url: payload.response_url,\n      user_id: payload.user.id,\n      user_name: payload.user.name,\n      trigger_type: 'shortcut'\n    }\n  };\n}\n\n// Case 2: Triggered via a button click (your current logic)\nconst value = payload.actions[0].value;\nconst parts = value.split('|');\n\nreturn {\n  json: {\n    target_language: parts[0],\n    source_language: parts[1],\n    text: parts.slice(2).join('|'),\n    response_url: payload.response_url,\n    user_id: payload.user.id,\n    user_name: payload.user.name,\n    trigger_type: 'button'\n  }\n};"
        },
        "id": "7520e4e3-476a-423f-9540-8b8faf1a14ed",
        "name": "ğŸ“‹ Parse Button Click",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          96,
          -592
        ],
        "disabled": true
      },
      {
        "parameters": {
          "options": {
            "responseCode": 200
          }
        },
        "id": "44c119b4-ec2c-4786-988d-5c12d221bdc7",
        "name": "âš¡ ACK Button",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          336,
          -592
        ],
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "replace_original",
                "value": "true"
              },
              {
                "name": "text",
                "value": "=â³ Translating to {{ $json.target_language }}..."
              }
            ]
          },
          "options": {}
        },
        "id": "100b0b06-5b68-4640-b971-a78e541dcece",
        "name": "â³ Show Translating",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          576,
          -592
        ],
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "const response = $input.first().json.output;\nconst inputData = $node[\"ğŸ“‹ Parse Button Click\"].json;\n\n// Updated Flag Map: en is now US flag\nconst flags = {\n  en: \"ğŸ‡ºğŸ‡¸\", fr: \"ğŸ‡«ğŸ‡·\", es: \"ğŸ‡ªğŸ‡¸\", de: \"ğŸ‡©ğŸ‡ª\",\n  he: \"ğŸ‡®ğŸ‡±\", ar: \"ğŸ‡¸ğŸ‡¦\", ja: \"ğŸ‡¯ğŸ‡µ\", zh: \"ğŸ‡¨ğŸ‡³\",\n  ru: \"ğŸ‡·ğŸ‡º\", it: \"ğŸ‡®ğŸ‡¹\", pt: \"ğŸ‡µğŸ‡¹\", ko: \"ğŸ‡°ğŸ‡·\"\n};\n\nconst langNames = {\n  en: \"English\", fr: \"French\", es: \"Spanish\", de: \"German\",\n  he: \"Hebrew\", ar: \"Arabic\", ja: \"Japanese\", zh: \"Chinese\",\n  ru: \"Russian\", it: \"Italian\", pt: \"Portuguese\", ko: \"Korean\"\n};\n\nconst rtlLangs = [\"he\", \"ar\"];\n\ntry {\n  const start = response.indexOf('{');\n  const end = response.lastIndexOf('}') + 1;\n  if (start === -1 || end === 0) throw new Error(\"No JSON found\");\n\n  const parsed = JSON.parse(response.slice(start, end));\n  let translation = parsed.translation || \"(Translation missing)\";\n\n  if (rtlLangs.includes(inputData.target_language)) {\n    translation = `\\u202B${translation}\\u202C`;\n  }\n\n  return {\n    json: {\n      detected_language_name: langNames[inputData.source_language] || inputData.source_language,\n      target_language_name: langNames[inputData.target_language] || inputData.target_language,\n      source_flag: flags[inputData.source_language] || \"ğŸŒ\",\n      target_flag: flags[inputData.target_language] || \"ğŸŒ\",\n      flag: flags[inputData.target_language] || \"ğŸŒ\", // Backward compatibility for existing blocks\n      original_text: inputData.text,\n      formatted_translation: translation,\n      response_url: inputData.response_url\n    }\n  };\n} catch (error) {\n  return { json: { formatted_translation: \"âŒ Error: \" + error.message, source_flag: \"âš ï¸\", target_flag: \"âš ï¸\" } };\n}"
        },
        "id": "0d76294e-e751-408b-87ce-33e7f73eb8fe",
        "name": "âœ… Parse Translation",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1152,
          -592
        ],
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": true,\n  \"blocks\": [\n    {\n      \"type\": \"header\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"ğŸŒ Translation Complete\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*ğŸ“ Original ({{ $json.source_flag }} {{ $json.detected_language_name }}):*\\n```{{ $json.original_text }}```\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*{{ $json.target_flag }} {{ $json.target_language_name }} Translation:*\\n```{{ $json.formatted_translation }}```\"\n      }\n    }\n  ]\n}",
          "options": {}
        },
        "id": "87b8212e-5066-4d43-bb41-6ede5e2d635b",
        "name": "âœ… Send Translation Result",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1360,
          -592
        ],
        "disabled": true
      },
      {
        "parameters": {
          "model": "openai/gpt-5-nano",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          896,
          -336
        ],
        "id": "1244af55-5a15-4df5-83a5-37d48ef07975",
        "name": "OpenRouter Chat Model",
        "credentials": {
          "openRouterApi": {
            "id": "hGAnvpSAhWRbFktq",
            "name": "OpenRouter account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": "openai/gpt-5-nano",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          688,
          -832
        ],
        "id": "053a874c-c8db-4bea-9946-fdb8c72547a4",
        "name": "OpenRouter Chat Model1",
        "credentials": {
          "openRouterApi": {
            "id": "hGAnvpSAhWRbFktq",
            "name": "OpenRouter account"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "google/gemma-3-27b",
            "mode": "list",
            "cachedResultName": "google/gemma-3-27b"
          },
          "options": {
            "frequencyPenalty": 0.3,
            "maxTokens": 1000,
            "presencePenalty": 0.1,
            "temperature": 0.1,
            "timeout": 60000,
            "topP": 0.9
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          464,
          -832
        ],
        "id": "4c37f41d-a057-4052-9f92-60f3b7a2e652",
        "name": "ğŸ¤– LLM (Detect)",
        "credentials": {
          "openAiApi": {
            "id": "WJsCuec8UzGRGVIc",
            "name": "Macbook ProM1 Pro"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "translate",
          "responseMode": "responseNode",
          "options": {}
        },
        "id": "a82220a2-2529-4eb0-8548-63e084dcee8f",
        "name": "ğŸ¯ Slack Webhook",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -144,
          -1040
        ],
        "webhookId": "translate-webhook",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "// Extract data from Slack slash command\nconst body = $input.first().json.body;\nconst text = body.text ? body.text.trim() : 'No text provided';\n\nreturn {\n  json: {\n    text: text,\n    user_id: body.user_id || 'unknown',\n    user_name: body.user_name || 'unknown',\n    channel_id: body.channel_id || 'unknown',\n    response_url: body.response_url || null\n  }\n};"
        },
        "id": "01d857f8-0fb2-4538-83b0-aaa7bb05c8c0",
        "name": "ğŸ“‹ Parse Input",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          96,
          -1040
        ],
        "disabled": true
      },
      {
        "parameters": {
          "options": {}
        },
        "id": "e8549515-b2a0-4eab-9fb4-4086f2515cd1",
        "name": "âš¡ Immediate Response",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          336,
          -1040
        ],
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Detect the language of this text and return ONLY a JSON object:\n\n{\n  \"language_code\": \"<ISO 639-1 code>\",\n  \"language_name\": \"<Full language name>\",\n  \"confidence\": \"high|medium|low\"\n}\n\nText: {{ $json.text }}",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are a language detection AI. Always output valid JSON only."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          576,
          -1040
        ],
        "id": "234b3630-11d4-4f68-a3cb-02569d446fc5",
        "name": "ğŸ” Detect Language",
        "disabled": true
      },
      {
        "parameters": {
          "jsCode": "const response = $input.first().json.output;\nconst inputData = $node[\"ğŸ“‹ Parse Input\"].json;\n\ntry {\n  const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n  const parsed = JSON.parse(jsonMatch[0]);\n  \n  return {\n    json: {\n      text: inputData.text,\n      detected_language: parsed.language_code,\n      detected_language_name: parsed.language_name,\n      response_url: inputData.response_url,\n      user_id: inputData.user_id,\n      user_name: inputData.user_name\n    }\n  };\n} catch (error) {\n  return {\n    json: {\n      text: inputData.text,\n      detected_language: 'en',\n      detected_language_name: 'English',\n      response_url: inputData.response_url,\n      user_id: inputData.user_id,\n      user_name: inputData.user_name\n    }\n  };\n}"
        },
        "id": "a5eecb62-2105-49d4-b2a8-d739507a6711",
        "name": "Parse Detection",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          928,
          -1040
        ],
        "disabled": true
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "bodyParameters": {
            "parameters": [
              {
                "name": "replace_original",
                "value": "true"
              },
              {
                "name": "text",
                "value": "=ğŸŒ *Translate Text*\n\nğŸ“ Original ({{ $json.detected_language_name }}):\n`{{ $json.text }}`\n\nğŸ‘‡ *Choose a language to translate to:*"
              },
              {
                "name": "blocks",
                "value": "=[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"ğŸŒ *Translate Text*\\n\\nğŸ“ Original ({{ $json.detected_language_name }}): `{{ $json.text }}`\\n\\nğŸ‘‡ *Choose a language to translate to:*\"\n    }\n  },\n  {\n    \"type\": \"actions\",\n    \"block_id\": \"lang_select\",\n    \"elements\": [\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ºğŸ‡¸ English\", \"emoji\": true },\n        \"value\": \"en|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_en\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡«ğŸ‡· French\", \"emoji\": true },\n        \"value\": \"fr|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_fr\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ªğŸ‡¸ Spanish\", \"emoji\": true },\n        \"value\": \"es|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_es\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡©ğŸ‡ª German\", \"emoji\": true },\n        \"value\": \"de|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_de\"\n      }\n    ]\n  },\n  {\n    \"type\": \"actions\",\n    \"block_id\": \"lang_select_2\",\n    \"elements\": [\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡± Hebrew\", \"emoji\": true },\n        \"value\": \"he|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_he\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¸ğŸ‡¦ Arabic\", \"emoji\": true },\n        \"value\": \"ar|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ar\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¯ğŸ‡µ Japanese\", \"emoji\": true },\n        \"value\": \"ja|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ja\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¨ğŸ‡³ Chinese\", \"emoji\": true },\n        \"value\": \"zh|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_zh\"\n      }\n    ]\n  },\n  {\n    \"type\": \"actions\",\n    \"block_id\": \"lang_select_3\",\n    \"elements\": [\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡·ğŸ‡º Russian\", \"emoji\": true },\n        \"value\": \"ru|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ru\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡¹ Italian\", \"emoji\": true },\n        \"value\": \"it|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_it\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡µğŸ‡¹ Portuguese\", \"emoji\": true },\n        \"value\": \"pt|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_pt\"\n      },\n      {\n        \"type\": \"button\",\n        \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡°ğŸ‡· Korean\", \"emoji\": true },\n        \"value\": \"ko|{{ $json.detected_language }}|{{ $json.text }}\",\n        \"action_id\": \"translate_ko\"\n      }\n    ]\n  }\n]"
              }
            ]
          },
          "options": {}
        },
        "id": "473c2777-b776-4c58-9c1e-3d19117c7943",
        "name": "ğŸ›ï¸ Show Language Buttons",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          1184,
          -1040
        ],
        "disabled": true
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=TASK: Translate the provided text.\nTARGET LANGUAGE: {{ $node[\"ğŸ“‹ Parse Button Click\"].json.target_language }}\nSOURCE LANGUAGE: {{ $node[\"ğŸ“‹ Parse Button Click\"].json.source_language }}\n\nINPUT TEXT:\n{{ $node[\"ğŸ“‹ Parse Button Click\"].json.text }}\n\nOUTPUT FORMAT (Return ONLY raw JSON):\n{\n  \"detected_language\": \"{{ $node[\"ğŸ“‹ Parse Button Click\"].json.source_language }}\",\n  \"target_language\": \"{{ $node[\"ğŸ“‹ Parse Button Click\"].json.target_language }}\",\n  \"translation\": \"...\"\n}\n\nCRITICAL: \n1. Do not include markdown formatting like ```json.\n2. Only translate the \"translation\" value.\n3. Do not add any conversational text.",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are a translation API. Output only valid JSON. Never add extra text."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          816,
          -592
        ],
        "id": "bd2b1429-7d56-4ef8-b18f-aa23f640f296",
        "name": "ğŸŒ AI Translator",
        "disabled": true
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "qwen/qwen3-coder-30b",
            "mode": "list",
            "cachedResultName": "qwen/qwen3-coder-30b"
          },
          "options": {
            "frequencyPenalty": 0.3,
            "maxTokens": 500,
            "presencePenalty": 0.1,
            "temperature": 0,
            "timeout": 120000,
            "topP": 0.8
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          656,
          -336
        ],
        "id": "8091f806-c86e-4e37-97cf-cbb2c785bc3e",
        "name": "ğŸ¤– LLM (Translate",
        "credentials": {
          "openAiApi": {
            "id": "WJsCuec8UzGRGVIc",
            "name": "Macbook ProM1 Pro"
          }
        },
        "disabled": true
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": false,
              "leftValue": "",
              "typeValidation": "strict"
            },
            "conditions": [
              {
                "id": "shortcut-check",
                "leftValue": "={{ $json.trigger_type }}",
                "rightValue": "shortcut",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "id": "03e84987-68c0-4793-9ca7-53f77b2c784a",
        "name": "ğŸ”€ Shortcut or Button?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -3408,
          1104
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $node['ğŸ“‹ Parse Button Click1'].json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": false,\n  \"response_type\": \"ephemeral\",\n  \"text\": \"â³ Detecting language...\"\n}",
          "options": {
            "timeout": 10000
          }
        },
        "id": "cb5bba20-e863-4abd-97c4-b608972265ec",
        "name": "â³ Show Detecting (Shortcut)",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -3072,
          1184
        ]
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Detect the language of this text and return ONLY a JSON object:\n\n{\n  \"language_code\": \"<ISO 639-1 code>\",\n  \"language_name\": \"<Full language name>\",\n  \"confidence\": \"high|medium|low\"\n}\n\nText: {{ $node['ğŸ“‹ Parse Button Click1'].json.text }}",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are a language detection API. Output only valid JSON. No markdown, no extra text."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          -2864,
          1184
        ],
        "id": "3db1c9bd-2025-418e-8d96-212929a308bc",
        "name": "ğŸ” Detect Language (Shortcut)"
      },
      {
        "parameters": {
          "jsCode": "const response = $input.first().json.output || '';\nconst inputData = $node['ğŸ“‹ Parse Button Click1'].json;\n\nlet detectedCode = 'unknown';\nlet detectedName = 'Unknown';\n\ntry {\n  const jsonMatch = response.match(/\\{[\\s\\S]*?\\}/);\n  if (jsonMatch) {\n    const parsed = JSON.parse(jsonMatch[0]);\n    detectedCode = parsed.language_code || 'unknown';\n    detectedName = parsed.language_name || 'Unknown';\n  }\n} catch (e) {\n  // Fallback: keep defaults\n}\n\nreturn {\n  json: {\n    text: inputData.text,\n    detected_language: detectedCode,\n    detected_language_name: detectedName,\n    response_url: inputData.response_url,\n    user_id: inputData.user_id,\n    user_name: inputData.user_name\n  }\n};"
        },
        "id": "16720ad1-4c42-497e-b42d-367ae0a8c731",
        "name": "ğŸ“‹ Parse Detection (Shortcut)",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2560,
          1184
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": false,\n  \"response_type\": \"ephemeral\",\n  \"blocks\": [\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"ğŸŒ *Translate Text*\\n\\nğŸ“ Original ({{ $json.detected_language_name }}): `{{ $json.text }}`\\n\\nğŸ‘‡ *Choose a language to translate to:*\"\n      }\n    },\n    {\n      \"type\": \"actions\",\n      \"block_id\": \"lang_select\",\n      \"elements\": [\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ºğŸ‡¸ English\", \"emoji\": true }, \"value\": \"en|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_en\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡«ğŸ‡· French\", \"emoji\": true }, \"value\": \"fr|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_fr\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ªğŸ‡¸ Spanish\", \"emoji\": true }, \"value\": \"es|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_es\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡©ğŸ‡ª German\", \"emoji\": true }, \"value\": \"de|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_de\" }\n      ]\n    },\n    {\n      \"type\": \"actions\",\n      \"block_id\": \"lang_select_2\",\n      \"elements\": [\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡± Hebrew\", \"emoji\": true }, \"value\": \"he|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_he\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¸ğŸ‡¦ Arabic\", \"emoji\": true }, \"value\": \"ar|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ar\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¯ğŸ‡µ Japanese\", \"emoji\": true }, \"value\": \"ja|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ja\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¨ğŸ‡³ Chinese\", \"emoji\": true }, \"value\": \"zh|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_zh\" }\n      ]\n    },\n    {\n      \"type\": \"actions\",\n      \"block_id\": \"lang_select_3\",\n      \"elements\": [\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡·ğŸ‡º Russian\", \"emoji\": true }, \"value\": \"ru|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ru\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡¹ Italian\", \"emoji\": true }, \"value\": \"it|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_it\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡µğŸ‡¹ Portuguese\", \"emoji\": true }, \"value\": \"pt|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_pt\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡°ğŸ‡· Korean\", \"emoji\": true }, \"value\": \"ko|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ko\" }\n      ]\n    }\n  ]\n}",
          "options": {
            "timeout": 10000
          }
        },
        "id": "f7570e68-2766-4873-9908-ba857092a021",
        "name": "ğŸ›ï¸ Show Language Buttons (Shortcut)",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -2320,
          1184
        ]
      },
      {
        "parameters": {
          "model": "openai/gpt-4.1-nano",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          -2720,
          1376
        ],
        "id": "54f652d3-f606-434a-8eba-ae05a2f8be83",
        "name": "OpenRouter (Shortcut Detect Fallback)",
        "credentials": {
          "openRouterApi": {
            "id": "hGAnvpSAhWRbFktq",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "qwen/qwen3-coder-30b",
            "mode": "list",
            "cachedResultName": "qwen/qwen3-coder-30b"
          },
          "options": {
            "frequencyPenalty": 0.3,
            "maxTokens": 1000,
            "presencePenalty": 0.1,
            "temperature": 0.1,
            "timeout": 60000,
            "topP": 0.9
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2864,
          1360
        ],
        "id": "5500552b-430f-4bbb-b6dd-acfe3383ba3b",
        "name": "ğŸ¤– LLM (Shortcut Detect)",
        "credentials": {
          "openAiApi": {
            "id": "WJsCuec8UzGRGVIc",
            "name": "Macbook ProM1 Pro"
          }
        }
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": false,
              "leftValue": "",
              "typeValidation": "strict"
            },
            "conditions": [
              {
                "id": "input-error-check",
                "leftValue": "={{ $json.error }}",
                "rightValue": true,
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "id": "3505c229-c2f1-4e16-a584-f48dbc075157",
        "name": "â“ Has Text?",
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -3520,
          288
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": false,\n  \"response_type\": \"ephemeral\",\n  \"text\": \"{{ $json.error_message }}\"\n}",
          "options": {
            "timeout": 10000
          }
        },
        "id": "36518935-56b3-449f-8efa-1e6d12809237",
        "name": "âš ï¸ Send Usage Error",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -3616,
          528
        ]
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "qwen/qwen3-coder-30b",
            "mode": "list",
            "cachedResultName": "qwen/qwen3-coder-30b"
          },
          "options": {
            "frequencyPenalty": 0.3,
            "maxTokens": 2000,
            "presencePenalty": 0.1,
            "temperature": 0.2,
            "timeout": 120000,
            "topP": 0.9
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -2896,
          1056
        ],
        "id": "ca7a4f5f-ebef-4406-8ea0-3dd331b9d7a8",
        "name": "ğŸ¤– LLM (Translate)",
        "credentials": {
          "openAiApi": {
            "id": "WJsCuec8UzGRGVIc",
            "name": "Macbook ProM1 Pro"
          }
        }
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "slack-interactive",
          "responseMode": "responseNode",
          "options": {}
        },
        "id": "b2c8c35b-a872-4bf3-8541-a28a1b54d09d",
        "name": "ğŸ”˜ Button Click Webhook1",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -3760,
          880
        ],
        "webhookId": "slack-interactive"
      },
      {
        "parameters": {
          "jsCode": "// Parse Slack interactive payload\nconst body = $input.first().json.body;\nlet payload;\ntry {\n  payload = JSON.parse(body.payload);\n} catch (e) {\n  throw new Error('Failed to parse Slack payload: ' + e.message);\n}\n\n// Case 1: Triggered via the \"Translate this\" message shortcut\nif (payload.type === 'message_action') {\n  const msgText = payload.message?.text || '';\n  if (!msgText.trim()) {\n    throw new Error('No text found in the selected message.');\n  }\n  return {\n    json: {\n      text: msgText,\n      target_language: '',\n      source_language: 'auto',\n      response_url: payload.response_url,\n      user_id: payload.user?.id || 'unknown',\n      user_name: payload.user?.name || 'unknown',\n      trigger_type: 'shortcut'\n    }\n  };\n}\n\n// Case 2: Triggered via a button click\nif (!payload.actions || !payload.actions.length) {\n  throw new Error('No actions found in payload.');\n}\n\nconst value = payload.actions[0].value || '';\nconst parts = value.split('|');\n\nif (parts.length < 3) {\n  throw new Error('Invalid button value format. Expected: target|source|text');\n}\n\nreturn {\n  json: {\n    target_language: parts[0],\n    source_language: parts[1],\n    text: parts.slice(2).join('|'),\n    response_url: payload.response_url,\n    user_id: payload.user?.id || 'unknown',\n    user_name: payload.user?.name || 'unknown',\n    trigger_type: 'button'\n  }\n};"
        },
        "id": "91d41ce2-63de-41af-8267-3a01f231f374",
        "name": "ğŸ“‹ Parse Button Click1",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -3520,
          880
        ]
      },
      {
        "parameters": {
          "options": {
            "responseCode": 200
          }
        },
        "id": "3a6e5e1e-7456-4c78-997a-2b3ee12a9b18",
        "name": "âš¡ ACK Button1",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          -3280,
          880
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $node['ğŸ“‹ Parse Button Click1'].json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": true,\n  \"text\": \"â³ Translating to {{ $node['ğŸ“‹ Parse Button Click1'].json.target_language }}...\"\n}",
          "options": {
            "timeout": 10000
          }
        },
        "id": "7aab6594-d792-4436-8452-6045f80c3574",
        "name": "â³ Show Translating1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -3040,
          880
        ]
      },
      {
        "parameters": {
          "jsCode": "const response = $input.first().json.output || '';\nconst inputData = $node['ğŸ“‹ Parse Button Click1'].json;\n\nconst flags = {\n  en: 'ğŸ‡ºğŸ‡¸', fr: 'ğŸ‡«ğŸ‡·', es: 'ğŸ‡ªğŸ‡¸', de: 'ğŸ‡©ğŸ‡ª',\n  he: 'ğŸ‡®ğŸ‡±', ar: 'ğŸ‡¸ğŸ‡¦', ja: 'ğŸ‡¯ğŸ‡µ', zh: 'ğŸ‡¨ğŸ‡³',\n  ru: 'ğŸ‡·ğŸ‡º', it: 'ğŸ‡®ğŸ‡¹', pt: 'ğŸ‡µğŸ‡¹', ko: 'ğŸ‡°ğŸ‡·'\n};\n\nconst langNames = {\n  en: 'English', fr: 'French', es: 'Spanish', de: 'German',\n  he: 'Hebrew', ar: 'Arabic', ja: 'Japanese', zh: 'Chinese',\n  ru: 'Russian', it: 'Italian', pt: 'Portuguese', ko: 'Korean'\n};\n\nconst rtlLangs = ['he', 'ar'];\n\ntry {\n  // Robust JSON extraction: try full response first, then regex\n  let parsed;\n  const trimmed = response.trim();\n\n  // Strip markdown code fences if present\n  const cleaned = trimmed.replace(/^```(?:json)?\\s*/i, '').replace(/\\s*```$/i, '').trim();\n\n  try {\n    parsed = JSON.parse(cleaned);\n  } catch {\n    const jsonMatch = cleaned.match(/\\{[\\s\\S]*\\}/);\n    if (!jsonMatch) throw new Error('No JSON object found in LLM response');\n    parsed = JSON.parse(jsonMatch[0]);\n  }\n\n  let translation = parsed.translation;\n  if (!translation || typeof translation !== 'string' || !translation.trim()) {\n    throw new Error('Translation field is missing or empty');\n  }\n\n  translation = translation.trim();\n\n  if (rtlLangs.includes(inputData.target_language)) {\n    translation = `\\u202B${translation}\\u202C`;\n  }\n\n  // Escape backticks for Slack code blocks\n  const safeOriginal = inputData.text.replace(/`/g, \"'\");\n  const safeTranslation = translation.replace(/`/g, \"'\");\n\n  return {\n    json: {\n      detected_language_name: langNames[inputData.source_language] || inputData.source_language,\n      target_language_name: langNames[inputData.target_language] || inputData.target_language,\n      source_flag: flags[inputData.source_language] || 'ğŸŒ',\n      target_flag: flags[inputData.target_language] || 'ğŸŒ',\n      original_text: safeOriginal,\n      formatted_translation: safeTranslation,\n      response_url: inputData.response_url,\n      error: false\n    }\n  };\n} catch (error) {\n  return {\n    json: {\n      detected_language_name: langNames[inputData.source_language] || inputData.source_language,\n      target_language_name: langNames[inputData.target_language] || inputData.target_language,\n      source_flag: 'âš ï¸',\n      target_flag: 'âš ï¸',\n      original_text: inputData.text,\n      formatted_translation: 'âŒ Translation failed: ' + error.message,\n      response_url: inputData.response_url,\n      error: true\n    }\n  };\n}"
        },
        "id": "f788802e-d3c7-414e-b3a3-bd41cb1ad2b9",
        "name": "âœ… Parse Translation1",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2464,
          880
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": true,\n  \"blocks\": [\n    {\n      \"type\": \"header\",\n      \"text\": {\n        \"type\": \"plain_text\",\n        \"text\": \"{{ $json.error ? 'âš ï¸ Translation Error' : 'ğŸŒ Translation Complete' }}\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*ğŸ“ Original ({{ $json.source_flag }} {{ $json.detected_language_name }}):*\\n```{{ $json.original_text }}```\"\n      }\n    },\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"*{{ $json.target_flag }} {{ $json.target_language_name }} Translation:*\\n```{{ $json.formatted_translation }}```\"\n      }\n    }\n  ]\n}",
          "options": {
            "timeout": 10000
          }
        },
        "id": "b2a86748-a359-4f01-8938-619e32e7f529",
        "name": "âœ… Send Translation Result1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -2256,
          880
        ]
      },
      {
        "parameters": {
          "model": "openai/gpt-4.1-nano",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          -2752,
          1040
        ],
        "id": "a72ad38d-91e6-4ea1-83f1-08e52ed5b75d",
        "name": "OpenRouter Chat Model2",
        "credentials": {
          "openRouterApi": {
            "id": "hGAnvpSAhWRbFktq",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "model": "openai/gpt-4.1-nano",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          -2992,
          384
        ],
        "id": "056d2e40-6f1b-4fd6-9593-6656aaaa685b",
        "name": "OpenRouter Chat Model3",
        "credentials": {
          "openRouterApi": {
            "id": "hGAnvpSAhWRbFktq",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "qwen/qwen3-coder-30b",
            "mode": "list",
            "cachedResultName": "qwen/qwen3-coder-30b"
          },
          "options": {
            "frequencyPenalty": 0.3,
            "maxTokens": 1000,
            "presencePenalty": 0.1,
            "temperature": 0.1,
            "timeout": 60000,
            "topP": 0.9
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3200,
          400
        ],
        "id": "6c325b92-b5ee-4497-90ca-a1fd91881a72",
        "name": "ğŸ¤– LLM (Detect)1",
        "credentials": {
          "openAiApi": {
            "id": "WJsCuec8UzGRGVIc",
            "name": "Macbook ProM1 Pro"
          }
        }
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "translate",
          "responseMode": "responseNode",
          "options": {}
        },
        "id": "90d19440-eb52-466e-a638-4c4212a53c96",
        "name": "ğŸ¯ Slack Webhook1",
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -4000,
          128
        ],
        "webhookId": "translate-webhook"
      },
      {
        "parameters": {
          "jsCode": "// Extract data from Slack slash command\nconst body = $input.first().json.body;\nconst text = body.text ? body.text.trim() : '';\n\nif (!text) {\n  return {\n    json: {\n      text: '',\n      user_id: body.user_id || 'unknown',\n      user_name: body.user_name || 'unknown',\n      channel_id: body.channel_id || 'unknown',\n      response_url: body.response_url || null,\n      error: true,\n      error_message: 'Please provide text to translate. Usage: `/translate Hello world`'\n    }\n  };\n}\n\nreturn {\n  json: {\n    text: text,\n    user_id: body.user_id || 'unknown',\n    user_name: body.user_name || 'unknown',\n    channel_id: body.channel_id || 'unknown',\n    response_url: body.response_url || null,\n    error: false\n  }\n};"
        },
        "id": "2188cd4b-7f79-4b3c-89e7-0a2566f511a7",
        "name": "ğŸ“‹ Parse Input1",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -3760,
          128
        ]
      },
      {
        "parameters": {
          "options": {}
        },
        "id": "914de092-0d7f-4f6a-866c-e3bb1e0f7cab",
        "name": "âš¡ Immediate Response1",
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.1,
        "position": [
          -3520,
          128
        ]
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Detect the language of this text and return ONLY a JSON object:\n\n{\n  \"language_code\": \"<ISO 639-1 code>\",\n  \"language_name\": \"<Full language name>\",\n  \"confidence\": \"high|medium|low\"\n}\n\nText: {{ $json.text }}",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are a language detection API. Output only valid JSON. No markdown, no extra text, no code fences."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          -3280,
          128
        ],
        "id": "72741921-894c-4759-8582-9d1ccf4d9b11",
        "name": "ğŸ” Detect Language1"
      },
      {
        "parameters": {
          "jsCode": "const response = $input.first().json.output || '';\nconst inputData = $node['ğŸ“‹ Parse Input1'].json;\n\nlet detectedCode = 'unknown';\nlet detectedName = 'Unknown';\n\ntry {\n  // Strip markdown code fences if present\n  const cleaned = response.trim().replace(/^```(?:json)?\\s*/i, '').replace(/\\s*```$/i, '').trim();\n\n  let parsed;\n  try {\n    parsed = JSON.parse(cleaned);\n  } catch {\n    const jsonMatch = cleaned.match(/\\{[\\s\\S]*?\\}/);\n    if (jsonMatch) {\n      parsed = JSON.parse(jsonMatch[0]);\n    }\n  }\n\n  if (parsed) {\n    detectedCode = parsed.language_code || 'unknown';\n    detectedName = parsed.language_name || 'Unknown';\n  }\n} catch (e) {\n  // Fallback: keep defaults\n}\n\nreturn {\n  json: {\n    text: inputData.text,\n    detected_language: detectedCode,\n    detected_language_name: detectedName,\n    response_url: inputData.response_url,\n    user_id: inputData.user_id,\n    user_name: inputData.user_name\n  }\n};"
        },
        "id": "7c10ad98-9fb7-47af-b845-5d8871cbf1e5",
        "name": "Parse Detection1",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2928,
          128
        ]
      },
      {
        "parameters": {
          "method": "POST",
          "url": "={{ $json.response_url }}",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"replace_original\": true,\n  \"blocks\": [\n    {\n      \"type\": \"section\",\n      \"text\": {\n        \"type\": \"mrkdwn\",\n        \"text\": \"ğŸŒ *Translate Text*\\n\\nğŸ“ Original ({{ $json.detected_language_name }}): `{{ $json.text }}`\\n\\nğŸ‘‡ *Choose a language to translate to:*\"\n      }\n    },\n    {\n      \"type\": \"actions\",\n      \"block_id\": \"lang_select\",\n      \"elements\": [\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ºğŸ‡¸ English\", \"emoji\": true }, \"value\": \"en|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_en\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡«ğŸ‡· French\", \"emoji\": true }, \"value\": \"fr|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_fr\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡ªğŸ‡¸ Spanish\", \"emoji\": true }, \"value\": \"es|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_es\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡©ğŸ‡ª German\", \"emoji\": true }, \"value\": \"de|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_de\" }\n      ]\n    },\n    {\n      \"type\": \"actions\",\n      \"block_id\": \"lang_select_2\",\n      \"elements\": [\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡± Hebrew\", \"emoji\": true }, \"value\": \"he|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_he\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¸ğŸ‡¦ Arabic\", \"emoji\": true }, \"value\": \"ar|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ar\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¯ğŸ‡µ Japanese\", \"emoji\": true }, \"value\": \"ja|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ja\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡¨ğŸ‡³ Chinese\", \"emoji\": true }, \"value\": \"zh|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_zh\" }\n      ]\n    },\n    {\n      \"type\": \"actions\",\n      \"block_id\": \"lang_select_3\",\n      \"elements\": [\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡·ğŸ‡º Russian\", \"emoji\": true }, \"value\": \"ru|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ru\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡®ğŸ‡¹ Italian\", \"emoji\": true }, \"value\": \"it|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_it\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡µğŸ‡¹ Portuguese\", \"emoji\": true }, \"value\": \"pt|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_pt\" },\n        { \"type\": \"button\", \"text\": { \"type\": \"plain_text\", \"text\": \"ğŸ‡°ğŸ‡· Korean\", \"emoji\": true }, \"value\": \"ko|{{ $json.detected_language }}|{{ $json.text }}\", \"action_id\": \"translate_ko\" }\n      ]\n    }\n  ]\n}",
          "options": {
            "timeout": 10000
          }
        },
        "id": "f437d7b4-1100-464f-bc60-6a43bf6457d4",
        "name": "ğŸ›ï¸ Show Language Buttons1",
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -2672,
          128
        ]
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=TASK: Translate the provided text.\nTARGET LANGUAGE: {{ $node['ğŸ“‹ Parse Button Click1'].json.target_language }}\nSOURCE LANGUAGE: {{ $node['ğŸ“‹ Parse Button Click1'].json.source_language }}\n\nINPUT TEXT:\n{{ $node['ğŸ“‹ Parse Button Click1'].json.text }}\n\nOUTPUT FORMAT (Return ONLY raw JSON, no markdown, no code fences):\n{\n  \"detected_language\": \"{{ $node['ğŸ“‹ Parse Button Click1'].json.source_language }}\",\n  \"target_language\": \"{{ $node['ğŸ“‹ Parse Button Click1'].json.target_language }}\",\n  \"translation\": \"...\"\n}\n\nCRITICAL:\n1. Do NOT wrap in ```json or any markdown.\n2. Only translate the \"translation\" value.\n3. Do NOT add any conversational text.\n4. Preserve meaning and tone, use natural phrasing in the target language.",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are a professional translation API. Output only valid JSON. Never add markdown formatting, code fences, or extra text. Translate naturally and idiomatically."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          -2800,
          880
        ],
        "id": "297aa91c-3e09-43b0-9a3a-dcdddc1d34c2",
        "name": "ğŸŒ AI Translator1"
      }
    ],
    "connections": {
      "ğŸ”˜ Button Click Webhook": {
        "main": [
          [
            {
              "node": "ğŸ“‹ Parse Button Click",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ“‹ Parse Button Click": {
        "main": [
          [
            {
              "node": "âš¡ ACK Button",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "âš¡ ACK Button": {
        "main": [
          [
            {
              "node": "â³ Show Translating",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "â³ Show Translating": {
        "main": [
          [
            {
              "node": "ğŸŒ AI Translator",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "âœ… Parse Translation": {
        "main": [
          [
            {
              "node": "âœ… Send Translation Result",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸŒ AI Translator",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "OpenRouter Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸ” Detect Language",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "ğŸ¤– LLM (Detect)": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸ” Detect Language",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ¯ Slack Webhook": {
        "main": [
          [
            {
              "node": "ğŸ“‹ Parse Input",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ“‹ Parse Input": {
        "main": [
          [
            {
              "node": "âš¡ Immediate Response",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "âš¡ Immediate Response": {
        "main": [
          [
            {
              "node": "ğŸ” Detect Language",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ” Detect Language": {
        "main": [
          [
            {
              "node": "Parse Detection",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Detection": {
        "main": [
          [
            {
              "node": "ğŸ›ï¸ Show Language Buttons",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸŒ AI Translator": {
        "main": [
          [
            {
              "node": "âœ… Parse Translation",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ¤– LLM (Translate": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸŒ AI Translator",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ”€ Shortcut or Button?": {
        "main": [
          [
            {
              "node": "â³ Show Detecting (Shortcut)",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "â³ Show Translating1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "â³ Show Detecting (Shortcut)": {
        "main": [
          [
            {
              "node": "ğŸ” Detect Language (Shortcut)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ” Detect Language (Shortcut)": {
        "main": [
          [
            {
              "node": "ğŸ“‹ Parse Detection (Shortcut)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ“‹ Parse Detection (Shortcut)": {
        "main": [
          [
            {
              "node": "ğŸ›ï¸ Show Language Buttons (Shortcut)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ¤– LLM (Shortcut Detect)": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸ” Detect Language (Shortcut)",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter (Shortcut Detect Fallback)": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸ” Detect Language (Shortcut)",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "â“ Has Text?": {
        "main": [
          [
            {
              "node": "âš ï¸ Send Usage Error",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "ğŸ” Detect Language1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ¤– LLM (Translate)": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸŒ AI Translator1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ”˜ Button Click Webhook1": {
        "main": [
          [
            {
              "node": "ğŸ“‹ Parse Button Click1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ“‹ Parse Button Click1": {
        "main": [
          [
            {
              "node": "âš¡ ACK Button1",
              "type": "main",
              "index": 0
            },
            {
              "node": "ğŸ”€ Shortcut or Button?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "â³ Show Translating1": {
        "main": [
          [
            {
              "node": "ğŸŒ AI Translator1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "âœ… Parse Translation1": {
        "main": [
          [
            {
              "node": "âœ… Send Translation Result1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Chat Model2": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸŒ AI Translator1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "OpenRouter Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸ” Detect Language1",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "ğŸ¤– LLM (Detect)1": {
        "ai_languageModel": [
          [
            {
              "node": "ğŸ” Detect Language1",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ¯ Slack Webhook1": {
        "main": [
          [
            {
              "node": "ğŸ“‹ Parse Input1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ“‹ Parse Input1": {
        "main": [
          [
            {
              "node": "âš¡ Immediate Response1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "âš¡ Immediate Response1": {
        "main": [
          [
            {
              "node": "â“ Has Text?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸ” Detect Language1": {
        "main": [
          [
            {
              "node": "Parse Detection1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Parse Detection1": {
        "main": [
          [
            {
              "node": "ğŸ›ï¸ Show Language Buttons1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "ğŸŒ AI Translator1": {
        "main": [
          [
            {
              "node": "âœ… Parse Translation1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Alex Vinokur",
    "name": "Version ed275c11",
    "description": "",
    "autosaved": false
  },
  "tags": []
}