{
  "updatedAt": "2026-02-17T19:00:25.547Z",
  "createdAt": "2025-09-02T14:14:42.893Z",
  "id": "GzAlS0kt9q4YI0n7",
  "name": "Slack Article Summarizer",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "url-verify-check",
              "leftValue": "={{$json[\"body\"][\"type\"]}}",
              "rightValue": "url_verification",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4672,
        2656
      ],
      "id": "e5908ce1-dfec-4179-9267-f5aa2bfcca8b",
      "name": "Is URL Verification?"
    },
    {
      "parameters": {
        "jsCode": "return [{ json: { challenge: $json.body.challenge } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4432,
        2560
      ],
      "id": "1cd40779-9d4c-4ed5-adf2-2b5340465f27",
      "name": "Return Challenge"
    },
    {
      "parameters": {
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -4192,
        2560
      ],
      "id": "6933fd3f-795a-436c-9389-4d55fe893106",
      "name": "Respond 200 (Challenge)"
    },
    {
      "parameters": {
        "respondWith": "text",
        "options": {
          "responseCode": 200
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        -4432,
        2752
      ],
      "id": "ac577640-bc46-476d-a8f3-677ebd8d141c",
      "name": "Respond 200 (Ack)"
    },
    {
      "parameters": {
        "jsCode": "// Extract URL from Slack event, deduplicate, skip bots/retries\nconst body = $json.body || $json;\nconst event = body.event || {};\nconst headers = $json.headers || {};\n\n// Skip retries\nif (headers['x-slack-retry-num']) return [];\n\n// Skip non-user messages\nconst skipSubtypes = ['bot_message','message_deleted','channel_join','channel_leave','channel_topic','channel_purpose','file_share','pinned_item','unpinned_item'];\nif (event.subtype && skipSubtypes.includes(event.subtype)) return [];\n\n// Skip message_changed that are just unfurls\nif (event.subtype === 'message_changed') {\n  const prev = event.previous_message?.text || '';\n  const curr = event.message?.text || '';\n  if (prev === curr) return [];\n}\n\n// Skip bots\nconst BOT_USER_ID = 'U07K8QJ9XYZ';\nif (event.type !== 'message' || event.bot_id || event.user === BOT_USER_ID || !event.text) return [];\n\n// Extract URLs\nconst text = event.text || '';\nconst urls = new Set();\n\n// Slack-formatted URLs: <https://...|label>\nconst slackRx = /<(https?:\\/\\/[^>|]+)(\\|[^>]+)?>/g;\nlet m;\nwhile ((m = slackRx.exec(text)) !== null) urls.add(m[1]);\n\n// Plain URLs\nconst plainRx = /https?:\\/\\/[^\\s<>\"'\\[\\]{}]+/g;\nwhile ((m = plainRx.exec(text)) !== null) urls.add(m[0].replace(/[.,;:)]+$/, ''));\n\nconst firstUrl = [...urls].find(u => u.match(/^https?:\\/\\/.+\\..+/));\nif (!firstUrl) return [];\n\n// Deduplication (4-hour window)\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.processedUrls) staticData.processedUrls = {};\nif (!staticData.processedMsgs) staticData.processedMsgs = {};\n\nconst msgKey = `${event.user}_${event.ts}`;\nif (staticData.processedMsgs[msgKey]) return [];\nstaticData.processedMsgs[msgKey] = Date.now();\n\nconst fourHoursAgo = Date.now() - 14400000;\nconst isDuplicate = staticData.processedUrls[firstUrl] > fourHoursAgo;\nif (!isDuplicate) staticData.processedUrls[firstUrl] = Date.now();\n\n// Cleanup entries older than 2 days\nconst twoDaysAgo = Date.now() - 172800000;\nfor (const k of Object.keys(staticData.processedUrls)) {\n  if (staticData.processedUrls[k] < twoDaysAgo) delete staticData.processedUrls[k];\n}\nfor (const k of Object.keys(staticData.processedMsgs)) {\n  if (staticData.processedMsgs[k] < twoDaysAgo) delete staticData.processedMsgs[k];\n}\n\nreturn [{\n  json: {\n    isDuplicate,\n    url: firstUrl,\n    slack_channel: event.channel,\n    slack_user: event.user,\n    slack_ts: event.ts\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -4192,
        2752
      ],
      "id": "91d67016-318b-44b5-9b69-27fe9561089a",
      "name": "Extract URL & Deduplicate"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "dup-check",
              "leftValue": "={{ $json.isDuplicate }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -3952,
        2752
      ],
      "id": "5dc37066-2a39-42a1-a3c1-f6dddc1bd73f",
      "name": "Is Duplicate?"
    },
    {
      "parameters": {
        "url": "={{$json.url}}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
            },
            {
              "name": "Accept",
              "value": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
            },
            {
              "name": "Accept-Language",
              "value": "en-US,en;q=0.9,he;q=0.8,ru;q=0.7"
            }
          ]
        },
        "options": {
          "redirect": {
            "redirect": {
              "maxRedirects": 5
            }
          },
          "timeout": 15000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3712,
        2848
      ],
      "id": "9b7c221e-b447-46a9-9936-a51881b2afd6",
      "name": "Fetch Page",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "jsCode": "// Extract article text from HTML\nconst html = $json.data || $json.html || $json.body || $json.content || '';\nconst url = $('Is Duplicate?').first().json.url || '';\n\nif (!html || html.length < 100) {\n  return [{ json: { error: 'No HTML content received', url } }];\n}\n\nconst MAX_LEN = 12000; // enough for good summary, not too much for LLM\nlet text = '';\n\n// 1. JSON-LD structured data (best quality)\ntry {\n  const ld = html.match(/<script[^>]*type=[\"']application\\/ld\\+json[\"'][^>]*>([\\s\\S]*?)<\\/script>/i);\n  if (ld) {\n    const d = JSON.parse(ld[1]);\n    if (d.articleBody && d.articleBody.length > 300) text = d.articleBody;\n  }\n} catch (e) {}\n\n// 2. <article> tag\nif (text.length < 300) {\n  const art = html.match(/<article[^>]*>([\\s\\S]*?)<\\/article>/i);\n  if (art) {\n    const extracted = art[1]\n      .replace(/<script[\\s\\S]*?<\\/script>/gi, '')\n      .replace(/<style[\\s\\S]*?<\\/style>/gi, '')\n      .replace(/<nav[\\s\\S]*?<\\/nav>/gi, '')\n      .replace(/<aside[\\s\\S]*?<\\/aside>/gi, '')\n      .replace(/<footer[\\s\\S]*?<\\/footer>/gi, '')\n      .replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\n    if (extracted.length > text.length) text = extracted;\n  }\n}\n\n// 3. <main> tag\nif (text.length < 300) {\n  const main = html.match(/<main[^>]*>([\\s\\S]*?)<\\/main>/i);\n  if (main) {\n    const extracted = main[1]\n      .replace(/<script[\\s\\S]*?<\\/script>/gi, '')\n      .replace(/<style[\\s\\S]*?<\\/style>/gi, '')\n      .replace(/<nav[\\s\\S]*?<\\/nav>/gi, '')\n      .replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\n    if (extracted.length > text.length) text = extracted;\n  }\n}\n\n// 4. Common content class patterns\nif (text.length < 300) {\n  const patterns = [\n    /<div[^>]*class=\"[^\"]*(?:art_body|article_text|article-body|post-content|entry-content|story-body|article__content|content-body)[^\"]*\"[^>]*>([\\s\\S]*?)<\\/div>/i\n  ];\n  for (const p of patterns) {\n    const match = html.match(p);\n    if (match) {\n      const extracted = match[1].replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\n      if (extracted.length > text.length) { text = extracted; break; }\n    }\n  }\n}\n\n// 5. Paragraph aggregation (fallback)\nif (text.length < 300) {\n  const paras = html.match(/<p[^>]*>(.*?)<\\/p>/gis);\n  if (paras && paras.length > 3) {\n    const good = paras\n      .map(p => p.replace(/<[^>]+>/g, '').trim())\n      .filter(p => p.length > 40 && !/cookie|privacy|subscribe|newsletter|הרשמה|פרטיות/i.test(p));\n    if (good.length >= 3) text = good.join('\\n\\n');\n  }\n}\n\n// Clean\ntext = text\n  .replace(/all rights reserved|כל הזכויות שמורות|copyright \\d{4}|©\\s*\\d{4}/gi, '')\n  .replace(/follow us on.*|עקבו אחרינו.*/gi, '')\n  .replace(/\\s+/g, ' ').trim();\n\nif (!text || text.length < 200) {\n  let reason = 'Could not extract article text.';\n  if (html.includes('נדרשת הרשמה') || html.includes('subscription')) reason += ' Site may require login.';\n  else if (html.length < 5000) reason += ' Page too small — may be blocked.';\n  else reason += ' Site may use JS rendering.';\n  return [{ json: { error: reason, url } }];\n}\n\n// Detect language\nconst heb = (text.match(/[\\u0590-\\u05FF]/g) || []).length;\nconst cyr = (text.match(/[\\u0400-\\u04FF]/g) || []).length;\nconst lat = (text.match(/[a-zA-Z]/g) || []).length;\nconst total = text.length;\nlet language = 'en';\nif (heb / total > 0.15) language = 'he';\nelse if (cyr / total > 0.15) language = 'ru';\n\n// Truncate for LLM\nif (text.length > MAX_LEN) text = text.substring(0, MAX_LEN) + '... [truncated]';\n\nreturn [{ json: { article: text, url, language, charCount: text.length } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3472,
        2848
      ],
      "id": "af18c159-a9be-4488-8edf-57c924fa1ef3",
      "name": "Extract Text & Detect Language"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "error-check",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -3232,
        2848
      ],
      "id": "2b6f8970-a1f9-49e8-931b-5c9bdfbcebd7",
      "name": "Has Error?"
    },
    {
      "parameters": {
        "jsCode": "const err = $json.error || 'Unknown error';\nconst url = $json.url || '';\nconst lang = $json.language || 'en';\n\nconst msgs = { he: '⚠️ נכשל בסיכום המאמר', ru: '⚠️ Не удалось обобщить статью', en: '⚠️ Failed to summarize article' };\nconst reasons = { he: 'סיבה:', ru: 'Причина:', en: 'Reason:' };\n\nreturn [{ json: { text: `${msgs[lang] || msgs.en}\\n${reasons[lang] || reasons.en} ${err}\\n\\n${url ? `<${url}|Link>` : ''}` } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2992,
        2752
      ],
      "id": "5d17f93a-f434-48be-bbb6-f01ba92f09a6",
      "name": "Format Error"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Summarize the following article in {{$json.language}}.\n\nRules:\n- Output ONLY valid JSON, no markdown fences, no extra text.\n- Return a short title and exactly 5 bullet points.\n- Each bullet: 2-4 sentences, 30-60 words, with specific details (names, dates, numbers, locations).\n- Do NOT include bullet characters (•) in your output.\n- Do NOT include filler like \"no further details available\".\n\nFormat:\n{\"title\": \"Short descriptive title\", \"bullets\": [\"Point 1...\", \"Point 2...\", \"Point 3...\", \"Point 4...\", \"Point 5...\"]}\n\nArticle:\n{{$json.article}}",
        "needsFallback": true,
        "options": {
          "systemMessage": "You are an expert article summarizer. Always output valid JSON only. Never wrap in markdown code fences. Never add preamble."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2992,
        2944
      ],
      "id": "b550e098-0ce6-4c1e-936a-eb360debe0bb",
      "name": "AI Summarizer"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "qwen/qwen3-coder-30b",
          "mode": "list",
          "cachedResultName": "qwen/qwen3-coder-30b"
        },
        "options": {
          "frequencyPenalty": 0.3,
          "maxTokens": 2500,
          "presencePenalty": 0.1,
          "temperature": 0.2,
          "timeout": 120000,
          "topP": 0.9
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -3120,
        3184
      ],
      "id": "b9155be3-f409-458a-ad08-0321f1c93e40",
      "name": "Local LLM",
      "credentials": {
        "openAiApi": {
          "id": "WJsCuec8UzGRGVIc",
          "name": "Macbook ProM1 Pro"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5-nano",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -2944,
        3184
      ],
      "id": "9376e33b-95a3-423a-b944-328dc13f0e31",
      "name": "OpenRouter Fallback",
      "credentials": {
        "openRouterApi": {
          "id": "hGAnvpSAhWRbFktq",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Parse and validate AI output, format for Slack\nlet raw = $json.output || $json.text || $json.content || '';\nif (typeof raw !== 'string') raw = JSON.stringify(raw);\n\nconst url = $('Extract Text & Detect Language').first().json.url || '';\nconst language = $('Extract Text & Detect Language').first().json.language || 'en';\n\n// Clean markdown fences\nlet s = raw.replace(/```json\\s*/gi, '').replace(/```\\s*/g, '');\nconst si = s.indexOf('{');\nconst ei = s.lastIndexOf('}');\nif (si > -1 && ei > si) s = s.substring(si, ei + 1);\ns = s.replace(/[\\r\\n]+/g, ' ').replace(/[\\u2018\\u2019]/g, \"'\").replace(/[\\u201C\\u201D]/g, '\"').trim();\n\nlet title = 'Summary';\nlet bullets = [];\n\ntry {\n  const obj = JSON.parse(s);\n  title = obj.title || 'Summary';\n  bullets = Array.isArray(obj.bullets) ? obj.bullets : [];\n} catch (e) {\n  // Regex fallback\n  const tm = s.match(/\"title\"\\s*:\\s*\"([^\"]+)\"/);\n  const bm = s.match(/\"bullets\"\\s*:\\s*\\[([\\s\\S]*?)\\]/);\n  if (tm) title = tm[1];\n  if (bm) bullets = [...bm[1].matchAll(/\"([^\"]+)\"/g)].map(m => m[1]).filter(b => b.length > 15);\n}\n\n// Clean bullets\nbullets = bullets\n  .map(b => String(b).replace(/^[•\\-\\s]+/, '').replace(/\\.{2,}/g, '.').replace(/\\s+/g, ' ').trim())\n  .filter(b => {\n    if (!b || b.length < 25) return false;\n    const lc = b.toLowerCase();\n    return !lc.includes('no further details') && !lc.includes('no additional details') &&\n           !lc.includes('לא נמצאו פרטים') && !lc.includes('אין פרטים') &&\n           !lc.includes('информация недоступна');\n  });\n\nif (bullets.length === 0) {\n  const noContent = { he: 'לא הצלחתי לחלץ מידע מהמאמר', ru: 'Не удалось извлечь информацию', en: 'Could not extract summary from article' };\n  return [{ json: { text: `⚠️ ${noContent[language] || noContent.en}\\n\\n${url ? `<${url}|Link>` : ''}` } }];\n}\n\n// Format for Slack\nconst RLM = '\\u200F';\nconst LRM = '\\u200E';\nconst wrapLatin = t => t.replace(/([A-Za-z0-9]+(?:[.,:/\\-][A-Za-z0-9]+)*)/g, `${LRM}$1${LRM}`);\n\nlet titleLine, bulletLines;\n\nif (language === 'he') {\n  const wt = wrapLatin(title);\n  titleLine = url ? `${RLM}:brain: <${url}|${wt}>` : `${RLM}:brain: ${wt}`;\n  bulletLines = bullets.map(b => `${RLM}• ${wrapLatin(b)}`);\n} else if (language === 'ru') {\n  titleLine = url ? `:brain: <${url}|${title}>` : `:brain: ${title}`;\n  bulletLines = bullets.map(b => `• ${b}`);\n} else {\n  titleLine = url ? `:brain: Summary: <${url}|${title}>` : `:brain: Summary: ${title}`;\n  bulletLines = bullets.map(b => `• ${b}`);\n}\n\nreturn [{ json: { text: [titleLine, '', ...bulletLines].join('\\n') } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2752,
        2944
      ],
      "id": "8848e523-0f5d-427b-8156-b9c3631e3986",
      "name": "Validate & Format"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C09BFKKCMQ8",
          "mode": "list",
          "cachedResultName": "n8n-sammarize"
        },
        "text": "={{$json.text}}",
        "otherOptions": {
          "includeLinkToWorkflow": false
        }
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -2512,
        2848
      ],
      "id": "5b4ea37a-21ec-4117-95a5-253dc3dab725",
      "name": "Send to Slack",
      "webhookId": "946820e3-d85c-43a1-a0e5-58777a4a0c86",
      "credentials": {
        "slackApi": {
          "id": "I5astSkOODZZU76Y",
          "name": "n8n Summery"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "slack-events",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -4928,
        2656
      ],
      "id": "e90348d2-93cb-4945-88f8-391fdbbc6211",
      "name": "Webhook",
      "webhookId": "d63266c1-1b49-4fc1-8530-cbdb5e8fb27f"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C09BFKKCMQ8",
          "mode": "list",
          "cachedResultName": "n8n-sammarize"
        },
        "text": "=ℹ️ This URL was already summarized recently.\n\n<{{$json.url}}|{{$json.url}}>",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -3712,
        2656
      ],
      "id": "198067bb-8dca-4c8d-ab31-fc153dff96bf",
      "name": "Send Duplicate Notice",
      "webhookId": "4c109572-f287-4e64-9bda-ffb85c1243de",
      "credentials": {
        "slackApi": {
          "id": "I5astSkOODZZU76Y",
          "name": "n8n Summery"
        }
      }
    }
  ],
  "connections": {
    "Is URL Verification?": {
      "main": [
        [
          {
            "node": "Return Challenge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Respond 200 (Ack)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Return Challenge": {
      "main": [
        [
          {
            "node": "Respond 200 (Challenge)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond 200 (Ack)": {
      "main": [
        [
          {
            "node": "Extract URL & Deduplicate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract URL & Deduplicate": {
      "main": [
        [
          {
            "node": "Is Duplicate?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Duplicate?": {
      "main": [
        [
          {
            "node": "Send Duplicate Notice",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Fetch Page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Page": {
      "main": [
        [
          {
            "node": "Extract Text & Detect Language",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Text & Detect Language": {
      "main": [
        [
          {
            "node": "Has Error?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Has Error?": {
      "main": [
        [
          {
            "node": "Format Error",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Summarizer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Error": {
      "main": [
        [
          {
            "node": "Send to Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Summarizer": {
      "main": [
        [
          {
            "node": "Validate & Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validate & Format": {
      "main": [
        [
          {
            "node": "Send to Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Local LLM": {
      "ai_languageModel": [
        [
          {
            "node": "AI Summarizer",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Fallback": {
      "ai_languageModel": [
        [
          {
            "node": "AI Summarizer",
            "type": "ai_languageModel",
            "index": 1
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Is URL Verification?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Jerusalem",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "binaryMode": "separate"
  },
  "staticData": {
    "global": {
      "metrics": {
        "total": 216,
        "success": 216
      },
      "processedUrls": {
        "https://www.jpost.com/middle-east/iran-news/article-886998": 1771354553600,
        "https://tech.walla.co.il/item/3817478": 1771354686625,
        "https://mnenia.zahav.ru/Articles/3817507/%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D1%82%D0%B2%D0%BE%5F%D1%81%D0%B8%D1%80%D0%B8%D0%B8%5F%D1%80%D0%B0%D0%B7%D0%B2%D0%B5%D1%80%D0%BD%D0%B5%D1%82%D1%81%D1%8F%5F%D0%B2%5F%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D1%83%5F%D0%B8%D0%B7%D1%80%D0%B0%D0%B8%D0%BB%D1%8F": 1771354751047,
        "https://www.one.co.il/Article/514742.html": 1771355132742
      },
      "processedEvents": {
        "1762243942.321019-undefined": 1762243945452
      },
      "processedMessages": {
        "U08AYDL2FQD_1771354645.863239": 1771354647255
      },
      "processedMsgs": {
        "U08AYDL2FQD_1771354551.768559": 1771354553600,
        "U08AYDL2FQD_1771354684.851769": 1771354686625,
        "U08AYDL2FQD_1771354748.451849": 1771354751047,
        "U08AYDL2FQD_1771355131.225819": 1771355132742
      }
    }
  },
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "bfb59fd3-7493-41d2-85cc-44b83e08b73f",
  "activeVersionId": "bfb59fd3-7493-41d2-85cc-44b83e08b73f",
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2025-10-31T09:14:00.820Z",
      "createdAt": "2025-10-31T09:14:00.820Z",
      "role": "workflow:owner",
      "workflowId": "GzAlS0kt9q4YI0n7",
      "projectId": "pWTWmuHnmIHw48U9"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-02-17T19:00:37.000Z",
    "createdAt": "2026-02-17T19:00:25.548Z",
    "versionId": "bfb59fd3-7493-41d2-85cc-44b83e08b73f",
    "workflowId": "GzAlS0kt9q4YI0n7",
    "nodes": [
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "url-verify-check",
                "leftValue": "={{$json[\"body\"][\"type\"]}}",
                "rightValue": "url_verification",
                "operator": {
                  "type": "string",
                  "operation": "equals"
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -4672,
          2656
        ],
        "id": "e5908ce1-dfec-4179-9267-f5aa2bfcca8b",
        "name": "Is URL Verification?"
      },
      {
        "parameters": {
          "jsCode": "return [{ json: { challenge: $json.body.challenge } }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -4432,
          2560
        ],
        "id": "1cd40779-9d4c-4ed5-adf2-2b5340465f27",
        "name": "Return Challenge"
      },
      {
        "parameters": {
          "options": {
            "responseCode": 200
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          -4192,
          2560
        ],
        "id": "6933fd3f-795a-436c-9389-4d55fe893106",
        "name": "Respond 200 (Challenge)"
      },
      {
        "parameters": {
          "respondWith": "text",
          "options": {
            "responseCode": 200
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.4,
        "position": [
          -4432,
          2752
        ],
        "id": "ac577640-bc46-476d-a8f3-677ebd8d141c",
        "name": "Respond 200 (Ack)"
      },
      {
        "parameters": {
          "jsCode": "// Extract URL from Slack event, deduplicate, skip bots/retries\nconst body = $json.body || $json;\nconst event = body.event || {};\nconst headers = $json.headers || {};\n\n// Skip retries\nif (headers['x-slack-retry-num']) return [];\n\n// Skip non-user messages\nconst skipSubtypes = ['bot_message','message_deleted','channel_join','channel_leave','channel_topic','channel_purpose','file_share','pinned_item','unpinned_item'];\nif (event.subtype && skipSubtypes.includes(event.subtype)) return [];\n\n// Skip message_changed that are just unfurls\nif (event.subtype === 'message_changed') {\n  const prev = event.previous_message?.text || '';\n  const curr = event.message?.text || '';\n  if (prev === curr) return [];\n}\n\n// Skip bots\nconst BOT_USER_ID = 'U07K8QJ9XYZ';\nif (event.type !== 'message' || event.bot_id || event.user === BOT_USER_ID || !event.text) return [];\n\n// Extract URLs\nconst text = event.text || '';\nconst urls = new Set();\n\n// Slack-formatted URLs: <https://...|label>\nconst slackRx = /<(https?:\\/\\/[^>|]+)(\\|[^>]+)?>/g;\nlet m;\nwhile ((m = slackRx.exec(text)) !== null) urls.add(m[1]);\n\n// Plain URLs\nconst plainRx = /https?:\\/\\/[^\\s<>\"'\\[\\]{}]+/g;\nwhile ((m = plainRx.exec(text)) !== null) urls.add(m[0].replace(/[.,;:)]+$/, ''));\n\nconst firstUrl = [...urls].find(u => u.match(/^https?:\\/\\/.+\\..+/));\nif (!firstUrl) return [];\n\n// Deduplication (4-hour window)\nconst staticData = $getWorkflowStaticData('global');\nif (!staticData.processedUrls) staticData.processedUrls = {};\nif (!staticData.processedMsgs) staticData.processedMsgs = {};\n\nconst msgKey = `${event.user}_${event.ts}`;\nif (staticData.processedMsgs[msgKey]) return [];\nstaticData.processedMsgs[msgKey] = Date.now();\n\nconst fourHoursAgo = Date.now() - 14400000;\nconst isDuplicate = staticData.processedUrls[firstUrl] > fourHoursAgo;\nif (!isDuplicate) staticData.processedUrls[firstUrl] = Date.now();\n\n// Cleanup entries older than 2 days\nconst twoDaysAgo = Date.now() - 172800000;\nfor (const k of Object.keys(staticData.processedUrls)) {\n  if (staticData.processedUrls[k] < twoDaysAgo) delete staticData.processedUrls[k];\n}\nfor (const k of Object.keys(staticData.processedMsgs)) {\n  if (staticData.processedMsgs[k] < twoDaysAgo) delete staticData.processedMsgs[k];\n}\n\nreturn [{\n  json: {\n    isDuplicate,\n    url: firstUrl,\n    slack_channel: event.channel,\n    slack_user: event.user,\n    slack_ts: event.ts\n  }\n}];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -4192,
          2752
        ],
        "id": "91d67016-318b-44b5-9b69-27fe9561089a",
        "name": "Extract URL & Deduplicate"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "dup-check",
                "leftValue": "={{ $json.isDuplicate }}",
                "rightValue": "true",
                "operator": {
                  "type": "boolean",
                  "operation": "true",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -3952,
          2752
        ],
        "id": "5dc37066-2a39-42a1-a3c1-f6dddc1bd73f",
        "name": "Is Duplicate?"
      },
      {
        "parameters": {
          "url": "={{$json.url}}",
          "sendHeaders": true,
          "headerParameters": {
            "parameters": [
              {
                "name": "User-Agent",
                "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
              },
              {
                "name": "Accept",
                "value": "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
              },
              {
                "name": "Accept-Language",
                "value": "en-US,en;q=0.9,he;q=0.8,ru;q=0.7"
              }
            ]
          },
          "options": {
            "redirect": {
              "redirect": {
                "maxRedirects": 5
              }
            },
            "timeout": 15000
          }
        },
        "type": "n8n-nodes-base.httpRequest",
        "typeVersion": 4.2,
        "position": [
          -3712,
          2848
        ],
        "id": "9b7c221e-b447-46a9-9936-a51881b2afd6",
        "name": "Fetch Page",
        "retryOnFail": true,
        "maxTries": 2
      },
      {
        "parameters": {
          "jsCode": "// Extract article text from HTML\nconst html = $json.data || $json.html || $json.body || $json.content || '';\nconst url = $('Is Duplicate?').first().json.url || '';\n\nif (!html || html.length < 100) {\n  return [{ json: { error: 'No HTML content received', url } }];\n}\n\nconst MAX_LEN = 12000; // enough for good summary, not too much for LLM\nlet text = '';\n\n// 1. JSON-LD structured data (best quality)\ntry {\n  const ld = html.match(/<script[^>]*type=[\"']application\\/ld\\+json[\"'][^>]*>([\\s\\S]*?)<\\/script>/i);\n  if (ld) {\n    const d = JSON.parse(ld[1]);\n    if (d.articleBody && d.articleBody.length > 300) text = d.articleBody;\n  }\n} catch (e) {}\n\n// 2. <article> tag\nif (text.length < 300) {\n  const art = html.match(/<article[^>]*>([\\s\\S]*?)<\\/article>/i);\n  if (art) {\n    const extracted = art[1]\n      .replace(/<script[\\s\\S]*?<\\/script>/gi, '')\n      .replace(/<style[\\s\\S]*?<\\/style>/gi, '')\n      .replace(/<nav[\\s\\S]*?<\\/nav>/gi, '')\n      .replace(/<aside[\\s\\S]*?<\\/aside>/gi, '')\n      .replace(/<footer[\\s\\S]*?<\\/footer>/gi, '')\n      .replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\n    if (extracted.length > text.length) text = extracted;\n  }\n}\n\n// 3. <main> tag\nif (text.length < 300) {\n  const main = html.match(/<main[^>]*>([\\s\\S]*?)<\\/main>/i);\n  if (main) {\n    const extracted = main[1]\n      .replace(/<script[\\s\\S]*?<\\/script>/gi, '')\n      .replace(/<style[\\s\\S]*?<\\/style>/gi, '')\n      .replace(/<nav[\\s\\S]*?<\\/nav>/gi, '')\n      .replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\n    if (extracted.length > text.length) text = extracted;\n  }\n}\n\n// 4. Common content class patterns\nif (text.length < 300) {\n  const patterns = [\n    /<div[^>]*class=\"[^\"]*(?:art_body|article_text|article-body|post-content|entry-content|story-body|article__content|content-body)[^\"]*\"[^>]*>([\\s\\S]*?)<\\/div>/i\n  ];\n  for (const p of patterns) {\n    const match = html.match(p);\n    if (match) {\n      const extracted = match[1].replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\n      if (extracted.length > text.length) { text = extracted; break; }\n    }\n  }\n}\n\n// 5. Paragraph aggregation (fallback)\nif (text.length < 300) {\n  const paras = html.match(/<p[^>]*>(.*?)<\\/p>/gis);\n  if (paras && paras.length > 3) {\n    const good = paras\n      .map(p => p.replace(/<[^>]+>/g, '').trim())\n      .filter(p => p.length > 40 && !/cookie|privacy|subscribe|newsletter|הרשמה|פרטיות/i.test(p));\n    if (good.length >= 3) text = good.join('\\n\\n');\n  }\n}\n\n// Clean\ntext = text\n  .replace(/all rights reserved|כל הזכויות שמורות|copyright \\d{4}|©\\s*\\d{4}/gi, '')\n  .replace(/follow us on.*|עקבו אחרינו.*/gi, '')\n  .replace(/\\s+/g, ' ').trim();\n\nif (!text || text.length < 200) {\n  let reason = 'Could not extract article text.';\n  if (html.includes('נדרשת הרשמה') || html.includes('subscription')) reason += ' Site may require login.';\n  else if (html.length < 5000) reason += ' Page too small — may be blocked.';\n  else reason += ' Site may use JS rendering.';\n  return [{ json: { error: reason, url } }];\n}\n\n// Detect language\nconst heb = (text.match(/[\\u0590-\\u05FF]/g) || []).length;\nconst cyr = (text.match(/[\\u0400-\\u04FF]/g) || []).length;\nconst lat = (text.match(/[a-zA-Z]/g) || []).length;\nconst total = text.length;\nlet language = 'en';\nif (heb / total > 0.15) language = 'he';\nelse if (cyr / total > 0.15) language = 'ru';\n\n// Truncate for LLM\nif (text.length > MAX_LEN) text = text.substring(0, MAX_LEN) + '... [truncated]';\n\nreturn [{ json: { article: text, url, language, charCount: text.length } }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -3472,
          2848
        ],
        "id": "af18c159-a9be-4488-8edf-57c924fa1ef3",
        "name": "Extract Text & Detect Language"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 2
            },
            "conditions": [
              {
                "id": "error-check",
                "leftValue": "={{ $json.error }}",
                "rightValue": "",
                "operator": {
                  "type": "string",
                  "operation": "notEmpty",
                  "singleValue": true
                }
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2.2,
        "position": [
          -3232,
          2848
        ],
        "id": "2b6f8970-a1f9-49e8-931b-5c9bdfbcebd7",
        "name": "Has Error?"
      },
      {
        "parameters": {
          "jsCode": "const err = $json.error || 'Unknown error';\nconst url = $json.url || '';\nconst lang = $json.language || 'en';\n\nconst msgs = { he: '⚠️ נכשל בסיכום המאמר', ru: '⚠️ Не удалось обобщить статью', en: '⚠️ Failed to summarize article' };\nconst reasons = { he: 'סיבה:', ru: 'Причина:', en: 'Reason:' };\n\nreturn [{ json: { text: `${msgs[lang] || msgs.en}\\n${reasons[lang] || reasons.en} ${err}\\n\\n${url ? `<${url}|Link>` : ''}` } }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2992,
          2752
        ],
        "id": "5d17f93a-f434-48be-bbb6-f01ba92f09a6",
        "name": "Format Error"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Summarize the following article in {{$json.language}}.\n\nRules:\n- Output ONLY valid JSON, no markdown fences, no extra text.\n- Return a short title and exactly 5 bullet points.\n- Each bullet: 2-4 sentences, 30-60 words, with specific details (names, dates, numbers, locations).\n- Do NOT include bullet characters (•) in your output.\n- Do NOT include filler like \"no further details available\".\n\nFormat:\n{\"title\": \"Short descriptive title\", \"bullets\": [\"Point 1...\", \"Point 2...\", \"Point 3...\", \"Point 4...\", \"Point 5...\"]}\n\nArticle:\n{{$json.article}}",
          "needsFallback": true,
          "options": {
            "systemMessage": "You are an expert article summarizer. Always output valid JSON only. Never wrap in markdown code fences. Never add preamble."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3.1,
        "position": [
          -2992,
          2944
        ],
        "id": "b550e098-0ce6-4c1e-936a-eb360debe0bb",
        "name": "AI Summarizer"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "qwen/qwen3-coder-30b",
            "mode": "list",
            "cachedResultName": "qwen/qwen3-coder-30b"
          },
          "options": {
            "frequencyPenalty": 0.3,
            "maxTokens": 2500,
            "presencePenalty": 0.1,
            "temperature": 0.2,
            "timeout": 120000,
            "topP": 0.9
          }
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          -3120,
          3184
        ],
        "id": "b9155be3-f409-458a-ad08-0321f1c93e40",
        "name": "Local LLM",
        "credentials": {
          "openAiApi": {
            "id": "WJsCuec8UzGRGVIc",
            "name": "Macbook ProM1 Pro"
          }
        }
      },
      {
        "parameters": {
          "model": "openai/gpt-5-nano",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
        "typeVersion": 1,
        "position": [
          -2944,
          3184
        ],
        "id": "9376e33b-95a3-423a-b944-328dc13f0e31",
        "name": "OpenRouter Fallback",
        "credentials": {
          "openRouterApi": {
            "id": "hGAnvpSAhWRbFktq",
            "name": "OpenRouter account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Parse and validate AI output, format for Slack\nlet raw = $json.output || $json.text || $json.content || '';\nif (typeof raw !== 'string') raw = JSON.stringify(raw);\n\nconst url = $('Extract Text & Detect Language').first().json.url || '';\nconst language = $('Extract Text & Detect Language').first().json.language || 'en';\n\n// Clean markdown fences\nlet s = raw.replace(/```json\\s*/gi, '').replace(/```\\s*/g, '');\nconst si = s.indexOf('{');\nconst ei = s.lastIndexOf('}');\nif (si > -1 && ei > si) s = s.substring(si, ei + 1);\ns = s.replace(/[\\r\\n]+/g, ' ').replace(/[\\u2018\\u2019]/g, \"'\").replace(/[\\u201C\\u201D]/g, '\"').trim();\n\nlet title = 'Summary';\nlet bullets = [];\n\ntry {\n  const obj = JSON.parse(s);\n  title = obj.title || 'Summary';\n  bullets = Array.isArray(obj.bullets) ? obj.bullets : [];\n} catch (e) {\n  // Regex fallback\n  const tm = s.match(/\"title\"\\s*:\\s*\"([^\"]+)\"/);\n  const bm = s.match(/\"bullets\"\\s*:\\s*\\[([\\s\\S]*?)\\]/);\n  if (tm) title = tm[1];\n  if (bm) bullets = [...bm[1].matchAll(/\"([^\"]+)\"/g)].map(m => m[1]).filter(b => b.length > 15);\n}\n\n// Clean bullets\nbullets = bullets\n  .map(b => String(b).replace(/^[•\\-\\s]+/, '').replace(/\\.{2,}/g, '.').replace(/\\s+/g, ' ').trim())\n  .filter(b => {\n    if (!b || b.length < 25) return false;\n    const lc = b.toLowerCase();\n    return !lc.includes('no further details') && !lc.includes('no additional details') &&\n           !lc.includes('לא נמצאו פרטים') && !lc.includes('אין פרטים') &&\n           !lc.includes('информация недоступна');\n  });\n\nif (bullets.length === 0) {\n  const noContent = { he: 'לא הצלחתי לחלץ מידע מהמאמר', ru: 'Не удалось извлечь информацию', en: 'Could not extract summary from article' };\n  return [{ json: { text: `⚠️ ${noContent[language] || noContent.en}\\n\\n${url ? `<${url}|Link>` : ''}` } }];\n}\n\n// Format for Slack\nconst RLM = '\\u200F';\nconst LRM = '\\u200E';\nconst wrapLatin = t => t.replace(/([A-Za-z0-9]+(?:[.,:/\\-][A-Za-z0-9]+)*)/g, `${LRM}$1${LRM}`);\n\nlet titleLine, bulletLines;\n\nif (language === 'he') {\n  const wt = wrapLatin(title);\n  titleLine = url ? `${RLM}:brain: <${url}|${wt}>` : `${RLM}:brain: ${wt}`;\n  bulletLines = bullets.map(b => `${RLM}• ${wrapLatin(b)}`);\n} else if (language === 'ru') {\n  titleLine = url ? `:brain: <${url}|${title}>` : `:brain: ${title}`;\n  bulletLines = bullets.map(b => `• ${b}`);\n} else {\n  titleLine = url ? `:brain: Summary: <${url}|${title}>` : `:brain: Summary: ${title}`;\n  bulletLines = bullets.map(b => `• ${b}`);\n}\n\nreturn [{ json: { text: [titleLine, '', ...bulletLines].join('\\n') } }];"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -2752,
          2944
        ],
        "id": "8848e523-0f5d-427b-8156-b9c3631e3986",
        "name": "Validate & Format"
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "C09BFKKCMQ8",
            "mode": "list",
            "cachedResultName": "n8n-sammarize"
          },
          "text": "={{$json.text}}",
          "otherOptions": {
            "includeLinkToWorkflow": false
          }
        },
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2.3,
        "position": [
          -2512,
          2848
        ],
        "id": "5b4ea37a-21ec-4117-95a5-253dc3dab725",
        "name": "Send to Slack",
        "webhookId": "946820e3-d85c-43a1-a0e5-58777a4a0c86",
        "credentials": {
          "slackApi": {
            "id": "I5astSkOODZZU76Y",
            "name": "n8n Summery"
          }
        }
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "slack-events",
          "responseMode": "responseNode",
          "options": {}
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          -4928,
          2656
        ],
        "id": "e90348d2-93cb-4945-88f8-391fdbbc6211",
        "name": "Webhook",
        "webhookId": "d63266c1-1b49-4fc1-8530-cbdb5e8fb27f"
      },
      {
        "parameters": {
          "select": "channel",
          "channelId": {
            "__rl": true,
            "value": "C09BFKKCMQ8",
            "mode": "list",
            "cachedResultName": "n8n-sammarize"
          },
          "text": "=ℹ️ This URL was already summarized recently.\n\n<{{$json.url}}|{{$json.url}}>",
          "otherOptions": {}
        },
        "type": "n8n-nodes-base.slack",
        "typeVersion": 2.3,
        "position": [
          -3712,
          2656
        ],
        "id": "198067bb-8dca-4c8d-ab31-fc153dff96bf",
        "name": "Send Duplicate Notice",
        "webhookId": "4c109572-f287-4e64-9bda-ffb85c1243de",
        "credentials": {
          "slackApi": {
            "id": "I5astSkOODZZU76Y",
            "name": "n8n Summery"
          }
        }
      }
    ],
    "connections": {
      "Is URL Verification?": {
        "main": [
          [
            {
              "node": "Return Challenge",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Respond 200 (Ack)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Return Challenge": {
        "main": [
          [
            {
              "node": "Respond 200 (Challenge)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Respond 200 (Ack)": {
        "main": [
          [
            {
              "node": "Extract URL & Deduplicate",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract URL & Deduplicate": {
        "main": [
          [
            {
              "node": "Is Duplicate?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Duplicate?": {
        "main": [
          [
            {
              "node": "Send Duplicate Notice",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Fetch Page",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Fetch Page": {
        "main": [
          [
            {
              "node": "Extract Text & Detect Language",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Text & Detect Language": {
        "main": [
          [
            {
              "node": "Has Error?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Has Error?": {
        "main": [
          [
            {
              "node": "Format Error",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "AI Summarizer",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Format Error": {
        "main": [
          [
            {
              "node": "Send to Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "AI Summarizer": {
        "main": [
          [
            {
              "node": "Validate & Format",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Validate & Format": {
        "main": [
          [
            {
              "node": "Send to Slack",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Local LLM": {
        "ai_languageModel": [
          [
            {
              "node": "AI Summarizer",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "OpenRouter Fallback": {
        "ai_languageModel": [
          [
            {
              "node": "AI Summarizer",
              "type": "ai_languageModel",
              "index": 1
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Is URL Verification?",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Alex Vinokur",
    "name": "Version bfb59fd3",
    "description": "",
    "autosaved": true
  },
  "tags": []
}